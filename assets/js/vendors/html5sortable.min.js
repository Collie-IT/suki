var sortable=function(){"use strict";function e(e,t,n){if(void 0===n)return e&&e.h5s&&e.h5s.data&&e.h5s.data[t];e.h5s=e.h5s||{},e.h5s.data=e.h5s.data||{},e.h5s.data[t]=n}var t=function(e,t){if(!(e instanceof NodeList||e instanceof HTMLCollection||e instanceof Array))throw new Error("You must provide a nodeList/HTMLCollection/Array of elements to be filtered.");return"string"!=typeof t?Array.from(e):Array.from(e).filter((function(e){return 1===e.nodeType&&e.matches(t)}))},n=new Map,r=function(){function e(){this._config=new Map,this._placeholder=void 0,this._data=new Map}return Object.defineProperty(e.prototype,"config",{get:function(){var e={};return this._config.forEach((function(t,n){e[n]=t})),e},set:function(e){if("object"!=typeof e)throw new Error("You must provide a valid configuration object to the config setter.");var t=Object.assign({},e);this._config=new Map(Object.entries(t))},enumerable:!1,configurable:!0}),e.prototype.setConfig=function(e,t){if(!this._config.has(e))throw new Error("Trying to set invalid configuration item: "+e);this._config.set(e,t)},e.prototype.getConfig=function(e){if(!this._config.has(e))throw new Error("Invalid configuration item requested: "+e);return this._config.get(e)},Object.defineProperty(e.prototype,"placeholder",{get:function(){return this._placeholder},set:function(e){if(!(e instanceof HTMLElement)&&null!==e)throw new Error("A placeholder must be an html element or null.");this._placeholder=e},enumerable:!1,configurable:!0}),e.prototype.setData=function(e,t){if("string"!=typeof e)throw new Error("The key must be a string.");this._data.set(e,t)},e.prototype.getData=function(e){if("string"!=typeof e)throw new Error("The key must be a string.");return this._data.get(e)},e.prototype.deleteData=function(e){if("string"!=typeof e)throw new Error("The key must be a string.");return this._data.delete(e)},e}(),o=function(e){if(!(e instanceof HTMLElement))throw new Error("Please provide a sortable to the store function.");return n.has(e)||n.set(e,new r),n.get(e)};function a(e,t,n){if(e instanceof Array)for(var r=0;r<e.length;++r)a(e[r],t,n);else e.addEventListener(t,n),o(e).setData("event"+t,n)}function i(e,t){if(e instanceof Array)for(var n=0;n<e.length;++n)i(e[n],t);else e.removeEventListener(t,o(e).getData("event"+t)),o(e).deleteData("event"+t)}function l(e,t,n){if(e instanceof Array)for(var r=0;r<e.length;++r)l(e[r],t,n);else e.setAttribute(t,n)}function s(e,t){if(e instanceof Array)for(var n=0;n<e.length;++n)s(e[n],t);else e.removeAttribute(t)}var d=function(e){if(!e.parentElement||0===e.getClientRects().length)throw new Error("target element must be part of the dom");var t=e.getClientRects()[0];return{left:t.left+window.pageXOffset,right:t.right+window.pageXOffset,top:t.top+window.pageYOffset,bottom:t.bottom+window.pageYOffset}},c=function(e,t){if(!(e instanceof HTMLElement&&(t instanceof NodeList||t instanceof HTMLCollection||t instanceof Array)))throw new Error("You must provide an element and a list of elements.");return Array.from(t).indexOf(e)},f=function(e){if(!(e instanceof HTMLElement))throw new Error("Element is not a node element.");return null!==e.parentNode},u=function(e,t,n){if(!(e instanceof HTMLElement&&e.parentElement instanceof HTMLElement))throw new Error("target and element must be a node");e.parentElement.insertBefore(t,"before"===n?e:e.nextElementSibling)},p=function(e){if(!(e instanceof HTMLElement))throw new Error("You must provide a valid dom element");var t=window.getComputedStyle(e);return"border-box"===t.getPropertyValue("box-sizing")?parseInt(t.getPropertyValue("height"),10):["height","padding-top","padding-bottom"].map((function(e){var n=parseInt(t.getPropertyValue(e),10);return isNaN(n)?0:n})).reduce((function(e,t){return e+t}))},m=function(e){if(!(e instanceof HTMLElement))throw new Error("You must provide a valid dom element");var t=window.getComputedStyle(e);return["width","padding-left","padding-right"].map((function(e){var n=parseInt(t.getPropertyValue(e),10);return isNaN(n)?0:n})).reduce((function(e,t){return e+t}))},g=function(e,t){if(!(e instanceof Array))throw new Error("You must provide a Array of HTMLElements to be filtered.");return"string"!=typeof t?e:e.filter((function(e){return e.querySelector(t)instanceof HTMLElement||e.shadowRoot&&e.shadowRoot.querySelector(t)instanceof HTMLElement})).map((function(e){return e.querySelector(t)||e.shadowRoot&&e.shadowRoot.querySelector(t)}))},h=function(e){return e.composedPath&&e.composedPath()[0]||e.target},v=function(e,t,n){return{element:e,posX:n.pageX-t.left,posY:n.pageY-t.top}},y=function(e,t){if(!0===e.isSortable){var n=o(e).getConfig("acceptFrom");if(null!==n&&!1!==n&&"string"!=typeof n)throw new Error('HTML5Sortable: Wrong argument, "acceptFrom" must be "null", "false", or a valid selector string.');if(null!==n)return!1!==n&&n.split(",").filter((function(e){return e.length>0&&t.matches(e)})).length>0;if(e===t)return!0;if(void 0!==o(e).getConfig("connectWith")&&null!==o(e).getConfig("connectWith"))return o(e).getConfig("connectWith")===o(t).getConfig("connectWith")}return!1},E={items:null,connectWith:null,disableIEFix:null,acceptFrom:null,copy:!1,placeholder:null,placeholderClass:"sortable-placeholder",draggingClass:"sortable-dragging",hoverClass:!1,dropTargetContainerClass:!1,debounce:0,throttleTime:100,maxItems:0,itemSerializer:void 0,containerSerializer:void 0,customDragImage:null,orientation:"vertical"};var w,b,T,C,L,x,D,M,H,I=function(e,n){if("string"==typeof o(e).getConfig("hoverClass")){var r=o(e).getConfig("hoverClass").split(" ");!0===n?(a(e,"mousemove",function(e,t){var n=this;if(void 0===t&&(t=250),"function"!=typeof e)throw new Error("You must provide a function as the first argument for throttle.");if("number"!=typeof t)throw new Error("You must provide a number as the second argument for throttle.");var r=null;return function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];var i=Date.now();(null===r||i-r>=t)&&(r=i,e.apply(n,o))}}((function(n){0===n.buttons&&t(e.children,o(e).getConfig("items")).forEach((function(e){var t,o;e===n.target||e.contains(n.target)?(t=e.classList).add.apply(t,r):(o=e.classList).remove.apply(o,r)}))}),o(e).getConfig("throttleTime"))),a(e,"mouseleave",(function(){t(e.children,o(e).getConfig("items")).forEach((function(e){var t;(t=e.classList).remove.apply(t,r)}))}))):(i(e,"mousemove"),i(e,"mouseleave"))}},A=function(e){i(e,"dragstart"),i(e,"dragend"),i(e,"dragover"),i(e,"dragenter"),i(e,"drop"),i(e,"mouseenter"),i(e,"mouseleave")},S=function(e,t){e&&i(e,"dragleave"),t&&t!==e&&i(t,"dragleave")},Y=function(e){var t;(t=e).h5s&&delete t.h5s.data,s(e,"aria-dropeffect")},_=function(e){s(e,"aria-grabbed"),s(e,"aria-copied"),s(e,"draggable"),s(e,"role")};function O(e,t){if(t.composedPath)return t.composedPath().find((function(e){return e.isSortable}));for(;!0!==e.isSortable;)e=e.parentElement;return e}function P(n,r){var o=e(n,"opts"),a=t(n.children,o.items).filter((function(e){return e.contains(r)||e.shadowRoot&&e.shadowRoot.contains(r)}));return a.length>0?a[0]:r}var z=function(n){var r=e(n,"opts"),o=t(n.children,r.items),i=g(o,r.handle);(l(n,"aria-dropeffect","move"),e(n,"_disabled","false"),l(i,"draggable","true"),I(n,!0),!1===r.disableIEFix)&&("function"==typeof(document||window.document).createElement("span").dragDrop&&a(i,"mousedown",(function(){if(-1!==o.indexOf(this))this.dragDrop();else{for(var e=this.parentElement;-1===o.indexOf(e);)e=e.parentElement;e.dragDrop()}})))};function W(r,s){var I=String(s);return s=s||{},"string"==typeof r&&(r=document.querySelectorAll(r)),r instanceof HTMLElement&&(r=[r]),r=Array.prototype.slice.call(r),/serialize/.test(I)?r.map((function(n){var r=e(n,"opts");return function(n,r,o){if(void 0===r&&(r=function(e,t){return e}),void 0===o&&(o=function(e){return e}),!(n instanceof HTMLElement)||1==!n.isSortable)throw new Error("You need to provide a sortableContainer to be serialized.");if("function"!=typeof r||"function"!=typeof o)throw new Error("You need to provide a valid serializer for items and the container.");var a=e(n,"opts").items,i=t(n.children,a),l=i.map((function(e){return{parent:n,node:e,html:e.outerHTML,index:c(e,i)}}));return{container:o({node:n,itemCount:l.length}),items:l.map((function(e){return r(e,n)}))}}(n,r.itemSerializer,r.containerSerializer)})):(r.forEach((function(r){if(/enable|disable|destroy/.test(I))return W[I](r);["connectWith","disableIEFix"].forEach((function(e){Object.prototype.hasOwnProperty.call(s,e)&&null!==s[e]&&console.warn('HTML5Sortable: You are using the deprecated configuration "'+e+'". This will be removed in an upcoming version, make sure to migrate to the new options when updating.')})),s=Object.assign({},E,o(r).config,s),o(r).config=s,e(r,"opts",s),r.isSortable=!0,function(n){var r=e(n,"opts"),o=t(n.children,r.items),a=g(o,r.handle);e(n,"_disabled","false"),A(o),S(C,M),i(a,"mousedown"),i(n,"dragover"),i(n,"dragenter"),i(n,"drop")}(r);var Y,_=t(r.children,s.items);if(null!==s.placeholder&&void 0!==s.placeholder){var N=document.createElement(r.tagName);s.placeholder instanceof HTMLElement?N.appendChild(s.placeholder):N.innerHTML=s.placeholder,Y=N.children[0]}o(r).placeholder=function(e,t,n){var r;if(void 0===n&&(n="sortable-placeholder"),!(e instanceof HTMLElement))throw new Error("You must provide a valid element as a sortable.");if(!(t instanceof HTMLElement)&&void 0!==t)throw new Error("You must provide a valid element as a placeholder or set ot to undefined.");return void 0===t&&(["UL","OL"].includes(e.tagName)?t=document.createElement("li"):["TABLE","TBODY"].includes(e.tagName)?(t=document.createElement("tr")).innerHTML='<td colspan="100"></td>':t=document.createElement("div")),"string"==typeof n&&(r=t.classList).add.apply(r,n.split(" ")),t}(r,Y,s.placeholderClass),e(r,"items",s.items),s.acceptFrom?e(r,"acceptFrom",s.acceptFrom):s.connectWith&&e(r,"connectWith",s.connectWith),z(r),l(_,"role","option"),l(_,"aria-grabbed","false"),a(r,"dragstart",(function(e){var n=h(e);if(!0!==n.isSortable&&(e.stopImmediatePropagation(),(!s.handle||n.matches(s.handle))&&"false"!==n.getAttribute("draggable"))){var r=O(n,e),a=P(r,n);D=t(r.children,s.items),L=D.indexOf(a),x=c(a,r.children),C=r,function(e,t,n){if(!(e instanceof Event))throw new Error("setDragImage requires a DragEvent as the first argument.");if(!(t instanceof HTMLElement))throw new Error("setDragImage requires the dragged element as the second argument.");if(n||(n=v),e.dataTransfer&&e.dataTransfer.setDragImage){var r=n(t,d(t),e);if(!(r.element instanceof HTMLElement)||"number"!=typeof r.posX||"number"!=typeof r.posY)throw new Error("The customDragImage function you provided must return and object with the properties element[string], posX[integer], posY[integer].");e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setData("text/plain",h(e).id),e.dataTransfer.setDragImage(r.element,r.posX,r.posY)}}(e,a,s.customDragImage),b=p(a),T=m(a),a.classList.add(s.draggingClass),w=function(e,t){var n=e;return!0===o(t).getConfig("copy")&&(l(n=e.cloneNode(!0),"aria-copied","true"),e.parentElement.appendChild(n),n.style.display="none",n.oldDisplay=e.style.display),n}(a,r),l(w,"aria-grabbed","true"),r.dispatchEvent(new CustomEvent("sortstart",{detail:{origin:{elementIndex:x,index:L,container:C},item:w,originalTarget:n}}))}})),a(r,"dragenter",(function(n){var i=h(n),l=O(i,n);l&&l!==M&&(H=t(l.children,e(l,"items")).filter((function(e){return e!==o(r).placeholder})),s.dropTargetContainerClass&&l.classList.add(s.dropTargetContainerClass),l.dispatchEvent(new CustomEvent("sortenter",{detail:{origin:{elementIndex:x,index:L,container:C},destination:{container:l,itemsBeforeUpdate:H},item:w,originalTarget:i}})),a(l,"dragleave",(function(e){var t=e.relatedTarget||e.fromElement;e.currentTarget.contains(t)||(s.dropTargetContainerClass&&l.classList.remove(s.dropTargetContainerClass),l.dispatchEvent(new CustomEvent("sortleave",{detail:{origin:{elementIndex:x,index:L,container:l},item:w,originalTarget:i}})))}))),M=l})),a(r,"dragend",(function(t){if(w){w.classList.remove(s.draggingClass),l(w,"aria-grabbed","false"),"true"===w.getAttribute("aria-copied")&&"true"!==e(w,"dropped")&&w.remove(),void 0!==w.oldDisplay&&(w.style.display=w.oldDisplay,delete w.oldDisplay);var o=Array.from(n.values()).map((function(e){return e.placeholder})).filter((function(e){return e instanceof HTMLElement})).filter(f)[0];o&&o.remove(),r.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:x,index:L,container:C},item:w}})),M=null,w=null,b=null,T=null}})),a(r,"drop",(function(a){if(y(r,w.parentElement)){a.preventDefault(),a.stopPropagation(),e(w,"dropped","true");var i=Array.from(n.values()).map((function(e){return e.placeholder})).filter((function(e){return e instanceof HTMLElement})).filter(f)[0];if(i){i.replaceWith(w),void 0!==w.oldDisplay&&(w.style.display=w.oldDisplay,delete w.oldDisplay),r.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:x,index:L,container:C},item:w}}));var l=o(r).placeholder,d=t(C.children,s.items).filter((function(e){return e!==l})),u=!0===this.isSortable?this:this.parentElement,p=t(u.children,e(u,"items")).filter((function(e){return e!==l})),m=c(w,Array.from(w.parentElement.children).filter((function(e){return e!==l}))),g=c(w,p);s.dropTargetContainerClass&&u.classList.remove(s.dropTargetContainerClass),x===m&&C===u||r.dispatchEvent(new CustomEvent("sortupdate",{detail:{origin:{elementIndex:x,index:L,container:C,itemsBeforeUpdate:D,items:d},destination:{index:g,elementIndex:m,container:u,itemsBeforeUpdate:H,items:p},item:w}}))}else e(w,"dropped","false")}}));var j,F,q,R=(j=function(e,r,a,i){if(w)if(s.forcePlaceholderSize&&(o(e).placeholder.style.height=b+"px",o(e).placeholder.style.width=T+"px"),Array.from(e.children).indexOf(r)>-1){var l=p(r),f=m(r),g=c(o(e).placeholder,r.parentElement.children),h=c(r,r.parentElement.children);if(l>b||f>T){var v=l-b,y=f-T,E=d(r).top,C=d(r).left;if(g<h&&("vertical"===s.orientation&&i<E||"horizontal"===s.orientation&&a<C))return;if(g>h&&("vertical"===s.orientation&&i>E+l-v||"horizontal"===s.orientation&&a>C+f-y))return}void 0===w.oldDisplay&&(w.oldDisplay=w.style.display),"none"!==w.style.display&&(w.style.display="none");var L=!1;try{var x=d(r).top+r.offsetHeight/2,D=d(r).left+r.offsetWidth/2;L="vertical"===s.orientation&&i>=x||"horizontal"===s.orientation&&a>=D}catch(e){L=g<h}L?function(e,t){u(e,t,"after")}(r,o(e).placeholder):function(e,t){u(e,t,"before")}(r,o(e).placeholder),Array.from(n.values()).filter((function(e){return void 0!==e.placeholder})).forEach((function(t){t.placeholder!==o(e).placeholder&&t.placeholder.remove()}))}else{var M=Array.from(n.values()).filter((function(e){return void 0!==e.placeholder})).map((function(e){return e.placeholder}));-1!==M.indexOf(r)||e!==r||t(r.children,s.items).length||(M.forEach((function(e){return e.remove()})),r.appendChild(o(e).placeholder))}},void 0===(F=s.debounce)&&(F=0),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];clearTimeout(q),q=setTimeout((function(){j.apply(void 0,e)}),F)}),X=function(n){var r=n.target,a=!0===r.isSortable?r:O(r,n);if(r=P(a,r),w&&y(a,w.parentElement)&&"true"!==e(a,"_disabled")){var i=e(a,"opts");parseInt(i.maxItems)&&t(a.children,e(a,"items")).length>parseInt(i.maxItems)&&w.parentElement!==a||(n.preventDefault(),n.stopPropagation(),n.dataTransfer.dropEffect=!0===o(a).getConfig("copy")?"copy":"move",R(a,r,n.pageX,n.pageY))}};a(_.concat(r),"dragover",X),a(_.concat(r),"dragenter",X)})),r)}return W.destroy=function(n){!function(n){var r=e(n,"opts")||{},o=t(n.children,r.items),a=g(o,r.handle);I(n,!1),i(n,"dragover"),i(n,"dragenter"),i(n,"dragstart"),i(n,"dragend"),i(n,"drop"),Y(n),i(a,"mousedown"),A(o),_(o),S(C,M),n.isSortable=!1}(n)},W.enable=function(e){z(e)},W.disable=function(n){!function(n){var r=e(n,"opts"),o=t(n.children,r.items),a=g(o,r.handle);l(n,"aria-dropeffect","none"),e(n,"_disabled","true"),l(a,"draggable","false"),i(a,"mousedown"),I(n,!1)}(n)},W.__testing={data:e,removeItemEvents:A,removeItemData:_,removeSortableData:Y,removeContainerEvents:S},W}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZlbmRvcnMvaHRtbDVzb3J0YWJsZS5qcyJdLCJuYW1lcyI6WyJzb3J0YWJsZSIsImFkZERhdGEiLCJlbGVtZW50Iiwia2V5IiwidmFsdWUiLCJ1bmRlZmluZWQiLCJoNXMiLCJkYXRhIiwiZmlsdGVyIiwibm9kZXMiLCJzZWxlY3RvciIsIk5vZGVMaXN0IiwiSFRNTENvbGxlY3Rpb24iLCJBcnJheSIsIkVycm9yIiwiZnJvbSIsIml0ZW0iLCJub2RlVHlwZSIsIm1hdGNoZXMiLCJzdG9yZXMiLCJNYXAiLCJTdG9yZSIsInRoaXMiLCJfY29uZmlnIiwiX3BsYWNlaG9sZGVyIiwiX2RhdGEiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInByb3RvdHlwZSIsImdldCIsImNvbmZpZyIsImZvckVhY2giLCJzZXQiLCJtZXJnZWRDb25maWciLCJhc3NpZ24iLCJlbnRyaWVzIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsInNldENvbmZpZyIsImhhcyIsImdldENvbmZpZyIsInBsYWNlaG9sZGVyIiwiSFRNTEVsZW1lbnQiLCJzZXREYXRhIiwiZ2V0RGF0YSIsImRlbGV0ZURhdGEiLCJkZWxldGUiLCJzdG9yZSIsInNvcnRhYmxlRWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudE5hbWUiLCJjYWxsYmFjayIsImkiLCJsZW5ndGgiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiYWRkQXR0cmlidXRlIiwiYXR0cmlidXRlIiwic2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwib2Zmc2V0IiwicGFyZW50RWxlbWVudCIsImdldENsaWVudFJlY3RzIiwicmVjdCIsImxlZnQiLCJ3aW5kb3ciLCJwYWdlWE9mZnNldCIsInJpZ2h0IiwidG9wIiwicGFnZVlPZmZzZXQiLCJib3R0b20iLCJnZXRJbmRleCIsImVsZW1lbnRMaXN0IiwiaW5kZXhPZiIsImlzSW5Eb20iLCJwYXJlbnROb2RlIiwiaW5zZXJ0Tm9kZSIsInJlZmVyZW5jZU5vZGUiLCJuZXdFbGVtZW50IiwicG9zaXRpb24iLCJpbnNlcnRCZWZvcmUiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJnZXRFbGVtZW50SGVpZ2h0Iiwic3R5bGUiLCJnZXRDb21wdXRlZFN0eWxlIiwiZ2V0UHJvcGVydHlWYWx1ZSIsInBhcnNlSW50IiwibWFwIiwiaW50IiwiaXNOYU4iLCJyZWR1Y2UiLCJzdW0iLCJnZXRFbGVtZW50V2lkdGgiLCJnZXRIYW5kbGVzIiwiaXRlbXMiLCJxdWVyeVNlbGVjdG9yIiwic2hhZG93Um9vdCIsImdldEV2ZW50VGFyZ2V0IiwiZXZlbnQiLCJjb21wb3NlZFBhdGgiLCJ0YXJnZXQiLCJkZWZhdWx0RHJhZ0ltYWdlIiwiZHJhZ2dlZEVsZW1lbnQiLCJlbGVtZW50T2Zmc2V0IiwicG9zWCIsInBhZ2VYIiwicG9zWSIsInBhZ2VZIiwibGlzdHNDb25uZWN0ZWQiLCJkZXN0aW5hdGlvbiIsIm9yaWdpbiIsImlzU29ydGFibGUiLCJhY2NlcHRGcm9tIiwic3BsaXQiLCJzZWwiLCJkZWZhdWx0Q29uZmlndXJhdGlvbiIsImNvbm5lY3RXaXRoIiwiZGlzYWJsZUlFRml4IiwiY29weSIsInBsYWNlaG9sZGVyQ2xhc3MiLCJkcmFnZ2luZ0NsYXNzIiwiaG92ZXJDbGFzcyIsImRyb3BUYXJnZXRDb250YWluZXJDbGFzcyIsImRlYm91bmNlIiwidGhyb3R0bGVUaW1lIiwibWF4SXRlbXMiLCJpdGVtU2VyaWFsaXplciIsImNvbnRhaW5lclNlcmlhbGl6ZXIiLCJjdXN0b21EcmFnSW1hZ2UiLCJvcmllbnRhdGlvbiIsImRyYWdnaW5nIiwiZHJhZ2dpbmdIZWlnaHQiLCJkcmFnZ2luZ1dpZHRoIiwib3JpZ2luQ29udGFpbmVyIiwib3JpZ2luSW5kZXgiLCJvcmlnaW5FbGVtZW50SW5kZXgiLCJvcmlnaW5JdGVtc0JlZm9yZVVwZGF0ZSIsInByZXZpb3VzQ29udGFpbmVyIiwiZGVzdGluYXRpb25JdGVtc0JlZm9yZVVwZGF0ZSIsImVuYWJsZUhvdmVyQ2xhc3MiLCJzb3J0YWJsZUNvbnRhaW5lciIsImVuYWJsZSIsImhvdmVyQ2xhc3Nlc18xIiwiZm4iLCJ0aHJlc2hvbGQiLCJfdGhpcyIsImxhc3RFdmVudFRpbWVzdGFtcCIsImFyZ3MiLCJfaSIsImFyZ3VtZW50cyIsIm5vdyIsIkRhdGUiLCJhcHBseSIsInRocm90dGxlIiwiYnV0dG9ucyIsImNoaWxkcmVuIiwiX2EiLCJfYiIsImNvbnRhaW5zIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwicmVtb3ZlSXRlbUV2ZW50cyIsInJlbW92ZUNvbnRhaW5lckV2ZW50cyIsInJlbW92ZVNvcnRhYmxlRGF0YSIsInJlbW92ZUl0ZW1EYXRhIiwiZmluZFNvcnRhYmxlIiwiZmluZCIsImVsIiwiZmluZERyYWdFbGVtZW50Iiwib3B0aW9ucyIsIml0ZW1saXN0IiwiZWxlIiwiZW5hYmxlU29ydGFibGUiLCJvcHRzIiwiaGFuZGxlcyIsImhhbmRsZSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImRyYWdEcm9wIiwicGFyZW50Iiwic29ydGFibGVFbGVtZW50cyIsIm1ldGhvZCIsIlN0cmluZyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJzbGljZSIsImNhbGwiLCJ0ZXN0IiwiY3VzdG9tSXRlbVNlcmlhbGl6ZXIiLCJjdXN0b21Db250YWluZXJTZXJpYWxpemVyIiwic2VyaWFsaXplZEl0ZW0iLCJzZXJpYWxpemVkQ29udGFpbmVyIiwic2VyaWFsaXplZEl0ZW1zIiwibm9kZSIsImh0bWwiLCJvdXRlckhUTUwiLCJpbmRleCIsImNvbnRhaW5lciIsIml0ZW1Db3VudCIsInNlcmlhbGl6ZSIsImNvbmZpZ0tleSIsImhhc093blByb3BlcnR5IiwiY29uc29sZSIsIndhcm4iLCJyZWxvYWRTb3J0YWJsZSIsImN1c3RvbVBsYWNlaG9sZGVyIiwibGlzdEl0ZW1zIiwidGVtcENvbnRhaW5lciIsInRhZ05hbWUiLCJhcHBlbmRDaGlsZCIsImlubmVySFRNTCIsImluY2x1ZGVzIiwibWFrZVBsYWNlaG9sZGVyIiwiZSIsInN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiIsImdldEF0dHJpYnV0ZSIsImRyYWdJdGVtIiwiRXZlbnQiLCJkYXRhVHJhbnNmZXIiLCJzZXREcmFnSW1hZ2UiLCJkcmFnSW1hZ2UiLCJlZmZlY3RBbGxvd2VkIiwiaWQiLCJkcmFnZ2VkSXRlbSIsImRpdGVtIiwiY2xvbmVOb2RlIiwiZGlzcGxheSIsIm9sZERpc3BsYXkiLCJnZXREcmFnZ2luZyIsImRpc3BhdGNoRXZlbnQiLCJDdXN0b21FdmVudCIsImRldGFpbCIsImVsZW1lbnRJbmRleCIsIm9yaWdpbmFsVGFyZ2V0IiwiaXRlbXNCZWZvcmVVcGRhdGUiLCJvdXRUYXJnZXQiLCJyZWxhdGVkVGFyZ2V0IiwiZnJvbUVsZW1lbnQiLCJjdXJyZW50VGFyZ2V0IiwidmlzaWJsZVBsYWNlaG9sZGVyIiwidmFsdWVzIiwicHJldmVudERlZmF1bHQiLCJzdG9wUHJvcGFnYXRpb24iLCJyZXBsYWNlV2l0aCIsIm9yaWdpbkl0ZW1zIiwiZGVzdGluYXRpb25Db250YWluZXIiLCJkZXN0aW5hdGlvbkl0ZW1zIiwiZGVzdGluYXRpb25FbGVtZW50SW5kZXgiLCJkZXN0aW5hdGlvbkluZGV4IiwiZnVuYyIsIndhaXQiLCJ0aW1lb3V0IiwiZGVib3VuY2VkRHJhZ092ZXJFbnRlciIsImZvcmNlUGxhY2Vob2xkZXJTaXplIiwiaGVpZ2h0Iiwid2lkdGgiLCJ0aGlzSGVpZ2h0IiwidGhpc1dpZHRoIiwicGxhY2Vob2xkZXJJbmRleCIsInRoaXNJbmRleCIsImRlYWRab25lVmVydGljYWwiLCJkZWFkWm9uZUhvcml6b250YWwiLCJvZmZzZXRUb3AiLCJvZmZzZXRMZWZ0IiwicGxhY2VBZnRlciIsImVsZW1lbnRNaWRkbGVWZXJ0aWNhbCIsIm9mZnNldEhlaWdodCIsImVsZW1lbnRNaWRkbGVIb3Jpem9udGFsIiwib2Zmc2V0V2lkdGgiLCJpbnNlcnRBZnRlciIsInBsYWNlaG9sZGVycyIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJvbkRyYWdPdmVyRW50ZXIiLCJkcm9wRWZmZWN0IiwiY29uY2F0IiwiZGVzdHJveSIsImRlc3Ryb3lTb3J0YWJsZSIsImRpc2FibGUiLCJkaXNhYmxlU29ydGFibGUiLCJfX3Rlc3RpbmciXSwibWFwcGluZ3MiOiJBQVFBLElBQUlBLFNBQVksV0FDZCxhQVNBLFNBQVNDLEVBQVFDLEVBQVNDLEVBQUtDLEdBQzNCLFFBQWNDLElBQVZELEVBQ0EsT0FBT0YsR0FBV0EsRUFBUUksS0FBT0osRUFBUUksSUFBSUMsTUFBUUwsRUFBUUksSUFBSUMsS0FBS0osR0FHdEVELEVBQVFJLElBQU1KLEVBQVFJLEtBQU8sR0FDN0JKLEVBQVFJLElBQUlDLEtBQU9MLEVBQVFJLElBQUlDLE1BQVEsR0FDdkNMLEVBQVFJLElBQUlDLEtBQUtKLEdBQU9DLEVBb0JoQyxJQUFJSSxFQUFTLFNBQVdDLEVBQU9DLEdBQzNCLEtBQU1ELGFBQWlCRSxVQUFZRixhQUFpQkcsZ0JBQWtCSCxhQUFpQkksT0FDbkYsTUFBTSxJQUFJQyxNQUFNLGdGQUVwQixNQUF3QixpQkFBYkosRUFDQUcsTUFBTUUsS0FBS04sR0FFZkksTUFBTUUsS0FBS04sR0FBT0QsUUFBTyxTQUFVUSxHQUFRLE9BQXlCLElBQWxCQSxFQUFLQyxVQUFrQkQsRUFBS0UsUUFBUVIsT0FLN0ZTLEVBQVMsSUFBSUMsSUFNYkMsRUFBdUIsV0FDdkIsU0FBU0EsSUFDTEMsS0FBS0MsUUFBVSxJQUFJSCxJQUNuQkUsS0FBS0Usa0JBQWVuQixFQUNwQmlCLEtBQUtHLE1BQVEsSUFBSUwsSUF5SHJCLE9BdkhBTSxPQUFPQyxlQUFlTixFQUFNTyxVQUFXLFNBQVUsQ0FNN0NDLElBQUssV0FFRCxJQUFJQyxFQUFTLEdBS2IsT0FKQVIsS0FBS0MsUUFBUVEsU0FBUSxTQUFVM0IsRUFBT0QsR0FDbEMyQixFQUFPM0IsR0FBT0MsS0FHWDBCLEdBT1hFLElBQUssU0FBVUYsR0FDWCxHQUFzQixpQkFBWEEsRUFDUCxNQUFNLElBQUloQixNQUFNLHVFQUdwQixJQUFJbUIsRUFBZVAsT0FBT1EsT0FBTyxHQUFJSixHQUVyQ1IsS0FBS0MsUUFBVSxJQUFJ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QkEsRUFDaEJELG1CQUFvQkEsRUFDcEJELHNCQUF1QkEsR0FHcEJsSyxFQW54Q00iLCJmaWxlIjoidmVuZG9ycy9odG1sNXNvcnRhYmxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIEhUTUw1U29ydGFibGUgcGFja2FnZVxuICogaHR0cHM6Ly9naXRodWIuY29tL2x1a2Fzb3BwZXJtYW5uL2h0bWw1c29ydGFibGVcbiAqXG4gKiBNYWludGFpbmVkIGJ5IEx1a2FzIE9wcGVybWFubiA8bHVrYXNAdmVhLnJlPlxuICpcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAqL1xudmFyIHNvcnRhYmxlID0gKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8qKlxuICAgKiBHZXQgb3Igc2V0IGRhdGEgb24gZWxlbWVudFxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBlbGVtZW50XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBrZXlcbiAgICogQHBhcmFtIHthbnl9IHZhbHVlXG4gICAqIEByZXR1cm4geyp9XG4gICAqL1xuICBmdW5jdGlvbiBhZGREYXRhKGVsZW1lbnQsIGtleSwgdmFsdWUpIHtcbiAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgcmV0dXJuIGVsZW1lbnQgJiYgZWxlbWVudC5oNXMgJiYgZWxlbWVudC5oNXMuZGF0YSAmJiBlbGVtZW50Lmg1cy5kYXRhW2tleV07XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgICBlbGVtZW50Lmg1cyA9IGVsZW1lbnQuaDVzIHx8IHt9O1xuICAgICAgICAgIGVsZW1lbnQuaDVzLmRhdGEgPSBlbGVtZW50Lmg1cy5kYXRhIHx8IHt9O1xuICAgICAgICAgIGVsZW1lbnQuaDVzLmRhdGFba2V5XSA9IHZhbHVlO1xuICAgICAgfVxuICB9XG4gIC8qKlxuICAgKiBSZW1vdmUgZGF0YSBmcm9tIGVsZW1lbnRcbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWxlbWVudFxuICAgKi9cbiAgZnVuY3Rpb24gcmVtb3ZlRGF0YShlbGVtZW50KSB7XG4gICAgICBpZiAoZWxlbWVudC5oNXMpIHtcbiAgICAgICAgICBkZWxldGUgZWxlbWVudC5oNXMuZGF0YTtcbiAgICAgIH1cbiAgfVxuXG4gIC8qIGVzbGludC1lbnYgYnJvd3NlciAqL1xuICAvKipcbiAgICogRmlsdGVyIG9ubHkgd2FudGVkIG5vZGVzXG4gICAqIEBwYXJhbSB7Tm9kZUxpc3R8SFRNTENvbGxlY3Rpb258QXJyYXl9IG5vZGVzXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBzZWxlY3RvclxuICAgKiBAcmV0dXJucyB7QXJyYXl9XG4gICAqL1xuICB2YXIgZmlsdGVyID0gKGZ1bmN0aW9uIChub2Rlcywgc2VsZWN0b3IpIHtcbiAgICAgIGlmICghKG5vZGVzIGluc3RhbmNlb2YgTm9kZUxpc3QgfHwgbm9kZXMgaW5zdGFuY2VvZiBIVE1MQ29sbGVjdGlvbiB8fCBub2RlcyBpbnN0YW5jZW9mIEFycmF5KSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignWW91IG11c3QgcHJvdmlkZSBhIG5vZGVMaXN0L0hUTUxDb2xsZWN0aW9uL0FycmF5IG9mIGVsZW1lbnRzIHRvIGJlIGZpbHRlcmVkLicpO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiBzZWxlY3RvciAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShub2Rlcyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gQXJyYXkuZnJvbShub2RlcykuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7IHJldHVybiBpdGVtLm5vZGVUeXBlID09PSAxICYmIGl0ZW0ubWF0Y2hlcyhzZWxlY3Rvcik7IH0pO1xuICB9KTtcblxuICAvKiBlc2xpbnQtZW52IGJyb3dzZXIgKi9cbiAgLyogZXNsaW50LWRpc2FibGUgbm8tdXNlLWJlZm9yZS1kZWZpbmUgKi9cbiAgdmFyIHN0b3JlcyA9IG5ldyBNYXAoKTtcbiAgLyogZXNsaW50LWVuYWJsZSBuby11c2UtYmVmb3JlLWRlZmluZSAqL1xuICAvKipcbiAgICogU3RvcmVzIGRhdGEgJiBjb25maWd1cmF0aW9ucyBwZXIgU29ydGFibGVcbiAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ1xuICAgKi9cbiAgdmFyIFN0b3JlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgICAgZnVuY3Rpb24gU3RvcmUoKSB7XG4gICAgICAgICAgdGhpcy5fY29uZmlnID0gbmV3IE1hcCgpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmXG4gICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIgPSB1bmRlZmluZWQ7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWZcbiAgICAgICAgICB0aGlzLl9kYXRhID0gbmV3IE1hcCgpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmXG4gICAgICB9XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3RvcmUucHJvdG90eXBlLCBcImNvbmZpZ1wiLCB7XG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogZ2V0IHRoZSBjb25maWd1cmF0aW9uIG1hcCBvZiBhIGNsYXNzIGluc3RhbmNlXG4gICAgICAgICAgICogQG1ldGhvZCBjb25maWdcbiAgICAgICAgICAgKiBAcmV0dXJuIHtvYmplY3R9XG4gICAgICAgICAgICovXG4gICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIC8vIHRyYW5zZm9ybSBNYXAgdG8gb2JqZWN0XG4gICAgICAgICAgICAgIHZhciBjb25maWcgPSB7fTtcbiAgICAgICAgICAgICAgdGhpcy5fY29uZmlnLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgICAgICAgIGNvbmZpZ1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAvLyByZXR1cm4gb2JqZWN0XG4gICAgICAgICAgICAgIHJldHVybiBjb25maWc7XG4gICAgICAgICAgfSxcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBzZXQgdGhlIGNvbmZpZ3VyYXRpb24gb2YgYSBjbGFzcyBpbnN0YW5jZVxuICAgICAgICAgICAqIEBtZXRob2QgY29uZmlnXG4gICAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IGNvbmZpZyBvYmplY3Qgb2YgY29uZmlndXJhdGlvbnNcbiAgICAgICAgICAgKi9cbiAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjb25maWcgIT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBtdXN0IHByb3ZpZGUgYSB2YWxpZCBjb25maWd1cmF0aW9uIG9iamVjdCB0byB0aGUgY29uZmlnIHNldHRlci4nKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvLyBjb21iaW5lIGNvbmZpZyB3aXRoIGRlZmF1bHRcbiAgICAgICAgICAgICAgdmFyIG1lcmdlZENvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIGNvbmZpZyk7XG4gICAgICAgICAgICAgIC8vIGFkZCBjb25maWcgdG8gbWFwXG4gICAgICAgICAgICAgIHRoaXMuX2NvbmZpZyA9IG5ldyBNYXAoT2JqZWN0LmVudHJpZXMobWVyZ2VkQ29uZmlnKSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgLyoqXG4gICAgICAgKiBzZXQgaW5kaXZpZHVhbCBjb25maWd1cmF0aW9uIG9mIGEgY2xhc3MgaW5zdGFuY2VcbiAgICAgICAqIEBtZXRob2Qgc2V0Q29uZmlnXG4gICAgICAgKiBAcGFyYW0gIGtleSB2YWxpZCBjb25maWd1cmF0aW9uIGtleVxuICAgICAgICogQHBhcmFtICB2YWx1ZSBhbnkgdmFsdWVcbiAgICAgICAqIEByZXR1cm4gdm9pZFxuICAgICAgICovXG4gICAgICBTdG9yZS5wcm90b3R5cGUuc2V0Q29uZmlnID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgICAgICBpZiAoIXRoaXMuX2NvbmZpZy5oYXMoa2V5KSkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUcnlpbmcgdG8gc2V0IGludmFsaWQgY29uZmlndXJhdGlvbiBpdGVtOiBcIiArIGtleSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIHNldCBjb25maWdcbiAgICAgICAgICB0aGlzLl9jb25maWcuc2V0KGtleSwgdmFsdWUpO1xuICAgICAgfTtcbiAgICAgIC8qKlxuICAgICAgICogZ2V0IGFuIGluZGl2aWR1YWwgY29uZmlndXJhdGlvbiBvZiBhIGNsYXNzIGluc3RhbmNlXG4gICAgICAgKiBAbWV0aG9kIGdldENvbmZpZ1xuICAgICAgICogQHBhcmFtICBrZXkgdmFsaWQgY29uZmlndXJhdGlvbiBrZXlcbiAgICAgICAqIEByZXR1cm4gYW55IGNvbmZpZ3VyYXRpb24gdmFsdWVcbiAgICAgICAqL1xuICAgICAgU3RvcmUucHJvdG90eXBlLmdldENvbmZpZyA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICBpZiAoIXRoaXMuX2NvbmZpZy5oYXMoa2V5KSkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGNvbmZpZ3VyYXRpb24gaXRlbSByZXF1ZXN0ZWQ6IFwiICsga2V5KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZy5nZXQoa2V5KTtcbiAgICAgIH07XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3RvcmUucHJvdG90eXBlLCBcInBsYWNlaG9sZGVyXCIsIHtcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBnZXQgdGhlIHBsYWNlaG9sZGVyIGZvciBhIGNsYXNzIGluc3RhbmNlXG4gICAgICAgICAgICogQG1ldGhvZCBwbGFjZWhvbGRlclxuICAgICAgICAgICAqIEByZXR1cm4ge0hUTUxFbGVtZW50fG51bGx9XG4gICAgICAgICAgICovXG4gICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl9wbGFjZWhvbGRlcjtcbiAgICAgICAgICB9LFxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIHNldCB0aGUgcGxhY2Vob2xkZXIgZm9yIGEgY2xhc3MgaW5zdGFuY2VcbiAgICAgICAgICAgKiBAbWV0aG9kIHBsYWNlaG9sZGVyXG4gICAgICAgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gcGxhY2Vob2xkZXJcbiAgICAgICAgICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgICAgICAgICAqL1xuICAgICAgICAgIHNldDogZnVuY3Rpb24gKHBsYWNlaG9sZGVyKSB7XG4gICAgICAgICAgICAgIGlmICghKHBsYWNlaG9sZGVyIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpICYmIHBsYWNlaG9sZGVyICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0EgcGxhY2Vob2xkZXIgbXVzdCBiZSBhbiBodG1sIGVsZW1lbnQgb3IgbnVsbC4nKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB0aGlzLl9wbGFjZWhvbGRlciA9IHBsYWNlaG9sZGVyO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIC8qKlxuICAgICAgICogc2V0IGFuIGRhdGEgZW50cnlcbiAgICAgICAqIEBtZXRob2Qgc2V0RGF0YVxuICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGtleVxuICAgICAgICogQHBhcmFtIHthbnl9IHZhbHVlXG4gICAgICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgICAgICovXG4gICAgICBTdG9yZS5wcm90b3R5cGUuc2V0RGF0YSA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBrZXkgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIGtleSBtdXN0IGJlIGEgc3RyaW5nLicpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLl9kYXRhLnNldChrZXksIHZhbHVlKTtcbiAgICAgIH07XG4gICAgICAvKipcbiAgICAgICAqIGdldCBhbiBkYXRhIGVudHJ5XG4gICAgICAgKiBAbWV0aG9kIGdldERhdGFcbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgYW4gZXhpc3Rpbmcga2V5XG4gICAgICAgKiBAcmV0dXJuIHthbnl9XG4gICAgICAgKi9cbiAgICAgIFN0b3JlLnByb3RvdHlwZS5nZXREYXRhID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgIGlmICh0eXBlb2Yga2V5ICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBrZXkgbXVzdCBiZSBhIHN0cmluZy4nKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGEuZ2V0KGtleSk7XG4gICAgICB9O1xuICAgICAgLyoqXG4gICAgICAgKiBkZWxldGUgYW4gZGF0YSBlbnRyeVxuICAgICAgICogQG1ldGhvZCBkZWxldGVEYXRhXG4gICAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IGFuIGV4aXN0aW5nIGtleVxuICAgICAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICAgICAqL1xuICAgICAgU3RvcmUucHJvdG90eXBlLmRlbGV0ZURhdGEgPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBrZXkgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIGtleSBtdXN0IGJlIGEgc3RyaW5nLicpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdGhpcy5fZGF0YS5kZWxldGUoa2V5KTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gU3RvcmU7XG4gIH0oKSk7XG4gIC8qKlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBzb3J0YWJsZUVsZW1lbnRcbiAgICogQHJldHVybnMge0NsYXNzOiBTdG9yZX1cbiAgICovXG4gIHZhciBzdG9yZSA9IChmdW5jdGlvbiAoc29ydGFibGVFbGVtZW50KSB7XG4gICAgICAvLyBpZiBzb3J0YWJsZUVsZW1lbnQgaXMgd3JvbmcgdHlwZVxuICAgICAgaWYgKCEoc29ydGFibGVFbGVtZW50IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQbGVhc2UgcHJvdmlkZSBhIHNvcnRhYmxlIHRvIHRoZSBzdG9yZSBmdW5jdGlvbi4nKTtcbiAgICAgIH1cbiAgICAgIC8vIGNyZWF0ZSBuZXcgaW5zdGFuY2UgaWYgbm90IGF2aWxhYmxlXG4gICAgICBpZiAoIXN0b3Jlcy5oYXMoc29ydGFibGVFbGVtZW50KSkge1xuICAgICAgICAgIHN0b3Jlcy5zZXQoc29ydGFibGVFbGVtZW50LCBuZXcgU3RvcmUoKSk7XG4gICAgICB9XG4gICAgICAvLyByZXR1cm4gaW5zdGFuY2VcbiAgICAgIHJldHVybiBzdG9yZXMuZ2V0KHNvcnRhYmxlRWxlbWVudCk7XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge0FycmF5fEhUTUxFbGVtZW50fSBlbGVtZW50XG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFxuICAgKi9cbiAgZnVuY3Rpb24gYWRkRXZlbnRMaXN0ZW5lcihlbGVtZW50LCBldmVudE5hbWUsIGNhbGxiYWNrKSB7XG4gICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50Lmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoZWxlbWVudFtpXSwgZXZlbnROYW1lLCBjYWxsYmFjayk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGNhbGxiYWNrKTtcbiAgICAgIHN0b3JlKGVsZW1lbnQpLnNldERhdGEoXCJldmVudFwiICsgZXZlbnROYW1lLCBjYWxsYmFjayk7XG4gIH1cbiAgLyoqXG4gICAqIEBwYXJhbSB7QXJyYXk8SFRNTEVsZW1lbnQ+fEhUTUxFbGVtZW50fSBlbGVtZW50XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudE5hbWVcbiAgICovXG4gIGZ1bmN0aW9uIHJlbW92ZUV2ZW50TGlzdGVuZXIoZWxlbWVudCwgZXZlbnROYW1lKSB7XG4gICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50Lmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIoZWxlbWVudFtpXSwgZXZlbnROYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgc3RvcmUoZWxlbWVudCkuZ2V0RGF0YShcImV2ZW50XCIgKyBldmVudE5hbWUpKTtcbiAgICAgIHN0b3JlKGVsZW1lbnQpLmRlbGV0ZURhdGEoXCJldmVudFwiICsgZXZlbnROYW1lKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge0FycmF5PEhUTUxFbGVtZW50PnxIVE1MRWxlbWVudH0gZWxlbWVudFxuICAgKiBAcGFyYW0ge3N0cmluZ30gYXR0cmlidXRlXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZVxuICAgKi9cbiAgZnVuY3Rpb24gYWRkQXR0cmlidXRlKGVsZW1lbnQsIGF0dHJpYnV0ZSwgdmFsdWUpIHtcbiAgICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnQubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgYWRkQXR0cmlidXRlKGVsZW1lbnRbaV0sIGF0dHJpYnV0ZSwgdmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShhdHRyaWJ1dGUsIHZhbHVlKTtcbiAgfVxuICAvKipcbiAgICogQHBhcmFtIHtBcnJheXxIVE1MRWxlbWVudH0gZWxlbWVudFxuICAgKiBAcGFyYW0ge3N0cmluZ30gYXR0cmlidXRlXG4gICAqL1xuICBmdW5jdGlvbiByZW1vdmVBdHRyaWJ1dGUoZWxlbWVudCwgYXR0cmlidXRlKSB7XG4gICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50Lmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgIHJlbW92ZUF0dHJpYnV0ZShlbGVtZW50W2ldLCBhdHRyaWJ1dGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShhdHRyaWJ1dGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnRcbiAgICogQHJldHVybnMge09iamVjdH1cbiAgICovXG4gIHZhciBvZmZzZXQgPSAoZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgIGlmICghZWxlbWVudC5wYXJlbnRFbGVtZW50IHx8IGVsZW1lbnQuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3RhcmdldCBlbGVtZW50IG11c3QgYmUgcGFydCBvZiB0aGUgZG9tJyk7XG4gICAgICB9XG4gICAgICB2YXIgcmVjdCA9IGVsZW1lbnQuZ2V0Q2xpZW50UmVjdHMoKVswXTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgICAgbGVmdDogcmVjdC5sZWZ0ICsgd2luZG93LnBhZ2VYT2Zmc2V0LFxuICAgICAgICAgIHJpZ2h0OiByZWN0LnJpZ2h0ICsgd2luZG93LnBhZ2VYT2Zmc2V0LFxuICAgICAgICAgIHRvcDogcmVjdC50b3AgKyB3aW5kb3cucGFnZVlPZmZzZXQsXG4gICAgICAgICAgYm90dG9tOiByZWN0LmJvdHRvbSArIHdpbmRvdy5wYWdlWU9mZnNldFxuICAgICAgfTtcbiAgfSk7XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW5kIHJldHVybnMgYSBuZXcgZGVib3VuY2VkIHZlcnNpb24gb2YgdGhlIHBhc3NlZCBmdW5jdGlvbiB3aGljaCB3aWxsIHBvc3Rwb25lIGl0cyBleGVjdXRpb24gdW50aWwgYWZ0ZXIgd2FpdCBtaWxsaXNlY29uZHMgaGF2ZSBlbGFwc2VkXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgdG8gZGVib3VuY2VcbiAgICogQHBhcmFtIHtudW1iZXJ9IHRpbWUgdG8gd2FpdCBiZWZvcmUgY2FsbGluZyBmdW5jdGlvbiB3aXRoIGxhdGVzdCBhcmd1bWVudHMsIDAgLSBubyBkZWJvdW5jZVxuICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IC0gZGVib3VuY2VkIGZ1bmN0aW9uXG4gICAqL1xuICB2YXIgZGVib3VuY2UgPSAoZnVuY3Rpb24gKGZ1bmMsIHdhaXQpIHtcbiAgICAgIGlmICh3YWl0ID09PSB2b2lkIDApIHsgd2FpdCA9IDA7IH1cbiAgICAgIHZhciB0aW1lb3V0O1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgZnVuYy5hcHBseSh2b2lkIDAsIGFyZ3MpO1xuICAgICAgICAgIH0sIHdhaXQpO1xuICAgICAgfTtcbiAgfSk7XG5cbiAgLyogZXNsaW50LWVudiBicm93c2VyICovXG4gIC8qKlxuICAgKiBHZXQgcG9zaXRpb24gb2YgdGhlIGVsZW1lbnQgcmVsYXRpdmVseSB0byBpdHMgc2libGluZyBlbGVtZW50c1xuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBlbGVtZW50XG4gICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAqL1xuICB2YXIgZ2V0SW5kZXggPSAoZnVuY3Rpb24gKGVsZW1lbnQsIGVsZW1lbnRMaXN0KSB7XG4gICAgICBpZiAoIShlbGVtZW50IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHx8ICEoZWxlbWVudExpc3QgaW5zdGFuY2VvZiBOb2RlTGlzdCB8fCBlbGVtZW50TGlzdCBpbnN0YW5jZW9mIEhUTUxDb2xsZWN0aW9uIHx8IGVsZW1lbnRMaXN0IGluc3RhbmNlb2YgQXJyYXkpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgbXVzdCBwcm92aWRlIGFuIGVsZW1lbnQgYW5kIGEgbGlzdCBvZiBlbGVtZW50cy4nKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBBcnJheS5mcm9tKGVsZW1lbnRMaXN0KS5pbmRleE9mKGVsZW1lbnQpO1xuICB9KTtcblxuICAvKiBlc2xpbnQtZW52IGJyb3dzZXIgKi9cbiAgLyoqXG4gICAqIFRlc3Qgd2hldGhlciBlbGVtZW50IGlzIGluIERPTVxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBlbGVtZW50XG4gICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgKi9cbiAgdmFyIGlzSW5Eb20gPSAoZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgIGlmICghKGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0VsZW1lbnQgaXMgbm90IGEgbm9kZSBlbGVtZW50LicpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGVsZW1lbnQucGFyZW50Tm9kZSAhPT0gbnVsbDtcbiAgfSk7XG5cbiAgLyogZXNsaW50LWVudiBicm93c2VyICovXG4gIC8qKlxuICAgKiBJbnNlcnQgbm9kZSBiZWZvcmUgb3IgYWZ0ZXIgdGFyZ2V0XG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHJlZmVyZW5jZU5vZGUgLSByZWZlcmVuY2UgZWxlbWVudFxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBuZXdFbGVtZW50IC0gZWxlbWVudCB0byBiZSBpbnNlcnRlZFxuICAgKiBAcGFyYW0ge1N0cmluZ30gcG9zaXRpb24gLSBpbnNlcnQgYmVmb3JlIG9yIGFmdGVyIHJlZmVyZW5jZSBlbGVtZW50XG4gICAqL1xuICB2YXIgaW5zZXJ0Tm9kZSA9IGZ1bmN0aW9uIChyZWZlcmVuY2VOb2RlLCBuZXdFbGVtZW50LCBwb3NpdGlvbikge1xuICAgICAgaWYgKCEocmVmZXJlbmNlTm9kZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB8fCAhKHJlZmVyZW5jZU5vZGUucGFyZW50RWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcigndGFyZ2V0IGFuZCBlbGVtZW50IG11c3QgYmUgYSBub2RlJyk7XG4gICAgICB9XG4gICAgICByZWZlcmVuY2VOb2RlLnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKG5ld0VsZW1lbnQsIChwb3NpdGlvbiA9PT0gJ2JlZm9yZScgPyByZWZlcmVuY2VOb2RlIDogcmVmZXJlbmNlTm9kZS5uZXh0RWxlbWVudFNpYmxpbmcpKTtcbiAgfTtcbiAgLyoqXG4gICAqIEluc2VydCBiZWZvcmUgdGFyZ2V0XG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHRhcmdldFxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBlbGVtZW50XG4gICAqL1xuICB2YXIgaW5zZXJ0QmVmb3JlID0gZnVuY3Rpb24gKHRhcmdldCwgZWxlbWVudCkgeyByZXR1cm4gaW5zZXJ0Tm9kZSh0YXJnZXQsIGVsZW1lbnQsICdiZWZvcmUnKTsgfTtcbiAgLyoqXG4gICAqIEluc2VydCBhZnRlciB0YXJnZXRcbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gdGFyZ2V0XG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnRcbiAgICovXG4gIHZhciBpbnNlcnRBZnRlciA9IGZ1bmN0aW9uICh0YXJnZXQsIGVsZW1lbnQpIHsgcmV0dXJuIGluc2VydE5vZGUodGFyZ2V0LCBlbGVtZW50LCAnYWZ0ZXInKTsgfTtcblxuICAvKiBlc2xpbnQtZW52IGJyb3dzZXIgKi9cbiAgLyoqXG4gICAqIEZpbHRlciBvbmx5IHdhbnRlZCBub2Rlc1xuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBzb3J0YWJsZUNvbnRhaW5lclxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjdXN0b21TZXJpYWxpemVyXG4gICAqIEByZXR1cm5zIHtBcnJheX1cbiAgICovXG4gIHZhciBzZXJpYWxpemUgPSAoZnVuY3Rpb24gKHNvcnRhYmxlQ29udGFpbmVyLCBjdXN0b21JdGVtU2VyaWFsaXplciwgY3VzdG9tQ29udGFpbmVyU2VyaWFsaXplcikge1xuICAgICAgaWYgKGN1c3RvbUl0ZW1TZXJpYWxpemVyID09PSB2b2lkIDApIHsgY3VzdG9tSXRlbVNlcmlhbGl6ZXIgPSBmdW5jdGlvbiAoc2VyaWFsaXplZEl0ZW0sIHNvcnRhYmxlQ29udGFpbmVyKSB7IHJldHVybiBzZXJpYWxpemVkSXRlbTsgfTsgfVxuICAgICAgaWYgKGN1c3RvbUNvbnRhaW5lclNlcmlhbGl6ZXIgPT09IHZvaWQgMCkgeyBjdXN0b21Db250YWluZXJTZXJpYWxpemVyID0gZnVuY3Rpb24gKHNlcmlhbGl6ZWRDb250YWluZXIpIHsgcmV0dXJuIHNlcmlhbGl6ZWRDb250YWluZXI7IH07IH1cbiAgICAgIC8vIGNoZWNrIGZvciB2YWxpZCBzb3J0YWJsZUNvbnRhaW5lclxuICAgICAgaWYgKCEoc29ydGFibGVDb250YWluZXIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkgfHwgIXNvcnRhYmxlQ29udGFpbmVyLmlzU29ydGFibGUgPT09IHRydWUpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBuZWVkIHRvIHByb3ZpZGUgYSBzb3J0YWJsZUNvbnRhaW5lciB0byBiZSBzZXJpYWxpemVkLicpO1xuICAgICAgfVxuICAgICAgLy8gY2hlY2sgZm9yIHZhbGlkIHNlcmlhbGl6ZXJzXG4gICAgICBpZiAodHlwZW9mIGN1c3RvbUl0ZW1TZXJpYWxpemVyICE9PSAnZnVuY3Rpb24nIHx8IHR5cGVvZiBjdXN0b21Db250YWluZXJTZXJpYWxpemVyICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgbmVlZCB0byBwcm92aWRlIGEgdmFsaWQgc2VyaWFsaXplciBmb3IgaXRlbXMgYW5kIHRoZSBjb250YWluZXIuJyk7XG4gICAgICB9XG4gICAgICAvLyBnZXQgb3B0aW9uc1xuICAgICAgdmFyIG9wdGlvbnMgPSBhZGREYXRhKHNvcnRhYmxlQ29udGFpbmVyLCAnb3B0cycpO1xuICAgICAgdmFyIGl0ZW0gPSBvcHRpb25zLml0ZW1zO1xuICAgICAgLy8gc2VyaWFsaXplIGNvbnRhaW5lclxuICAgICAgdmFyIGl0ZW1zID0gZmlsdGVyKHNvcnRhYmxlQ29udGFpbmVyLmNoaWxkcmVuLCBpdGVtKTtcbiAgICAgIHZhciBzZXJpYWxpemVkSXRlbXMgPSBpdGVtcy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICBwYXJlbnQ6IHNvcnRhYmxlQ29udGFpbmVyLFxuICAgICAgICAgICAgICBub2RlOiBpdGVtLFxuICAgICAgICAgICAgICBodG1sOiBpdGVtLm91dGVySFRNTCxcbiAgICAgICAgICAgICAgaW5kZXg6IGdldEluZGV4KGl0ZW0sIGl0ZW1zKVxuICAgICAgICAgIH07XG4gICAgICB9KTtcbiAgICAgIC8vIHNlcmlhbGl6ZSBjb250YWluZXJcbiAgICAgIHZhciBjb250YWluZXIgPSB7XG4gICAgICAgICAgbm9kZTogc29ydGFibGVDb250YWluZXIsXG4gICAgICAgICAgaXRlbUNvdW50OiBzZXJpYWxpemVkSXRlbXMubGVuZ3RoXG4gICAgICB9O1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBjb250YWluZXI6IGN1c3RvbUNvbnRhaW5lclNlcmlhbGl6ZXIoY29udGFpbmVyKSxcbiAgICAgICAgICBpdGVtczogc2VyaWFsaXplZEl0ZW1zLm1hcChmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gY3VzdG9tSXRlbVNlcmlhbGl6ZXIoaXRlbSwgc29ydGFibGVDb250YWluZXIpOyB9KVxuICAgICAgfTtcbiAgfSk7XG5cbiAgLyogZXNsaW50LWVudiBicm93c2VyICovXG4gIC8qKlxuICAgKiBjcmVhdGUgYSBwbGFjZWhvbGRlciBlbGVtZW50XG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHNvcnRhYmxlRWxlbWVudCBhIHNpbmdsZSBzb3J0YWJsZVxuICAgKiBAcGFyYW0ge3N0cmluZ3x1bmRlZmluZWR9IHBsYWNlaG9sZGVyIGEgc3RyaW5nIHJlcHJlc2VudGluZyBhbiBodG1sIGVsZW1lbnRcbiAgICogQHBhcmFtIHtzdHJpbmd9IHBsYWNlaG9sZGVyQ2xhc3NlcyBhIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGNsYXNzZXMgdGhhdCBzaG91bGQgYmUgYWRkZWQgdG8gdGhlIHBsYWNlaG9sZGVyXG4gICAqL1xuICB2YXIgbWFrZVBsYWNlaG9sZGVyID0gKGZ1bmN0aW9uIChzb3J0YWJsZUVsZW1lbnQsIHBsYWNlaG9sZGVyLCBwbGFjZWhvbGRlckNsYXNzKSB7XG4gICAgICB2YXIgX2E7XG4gICAgICBpZiAocGxhY2Vob2xkZXJDbGFzcyA9PT0gdm9pZCAwKSB7IHBsYWNlaG9sZGVyQ2xhc3MgPSAnc29ydGFibGUtcGxhY2Vob2xkZXInOyB9XG4gICAgICBpZiAoIShzb3J0YWJsZUVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBtdXN0IHByb3ZpZGUgYSB2YWxpZCBlbGVtZW50IGFzIGEgc29ydGFibGUuJyk7XG4gICAgICB9XG4gICAgICAvLyBpZiBwbGFjZWhvbGRlciBpcyBub3QgYW4gZWxlbWVudFxuICAgICAgaWYgKCEocGxhY2Vob2xkZXIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkgJiYgcGxhY2Vob2xkZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignWW91IG11c3QgcHJvdmlkZSBhIHZhbGlkIGVsZW1lbnQgYXMgYSBwbGFjZWhvbGRlciBvciBzZXQgb3QgdG8gdW5kZWZpbmVkLicpO1xuICAgICAgfVxuICAgICAgLy8gaWYgbm8gcGxhY2Vob2xkZXIgZWxlbWVudCBpcyBnaXZlblxuICAgICAgaWYgKHBsYWNlaG9sZGVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBpZiAoWydVTCcsICdPTCddLmluY2x1ZGVzKHNvcnRhYmxlRWxlbWVudC50YWdOYW1lKSkge1xuICAgICAgICAgICAgICBwbGFjZWhvbGRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKFsnVEFCTEUnLCAnVEJPRFknXS5pbmNsdWRlcyhzb3J0YWJsZUVsZW1lbnQudGFnTmFtZSkpIHtcbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xuICAgICAgICAgICAgICAvLyBzZXQgY29sc3BhbiB0byBhbHdheXMgYWxsIHJvd3MsIG90aGVyd2lzZSB0aGUgaXRlbSBjYW4gb25seSBiZSBkcm9wcGVkIGluIGZpcnN0IGNvbHVtblxuICAgICAgICAgICAgICBwbGFjZWhvbGRlci5pbm5lckhUTUwgPSAnPHRkIGNvbHNwYW49XCIxMDBcIj48L3RkPic7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICBwbGFjZWhvbGRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8vIGFkZCBjbGFzc2VzIHRvIHBsYWNlaG9sZGVyXG4gICAgICBpZiAodHlwZW9mIHBsYWNlaG9sZGVyQ2xhc3MgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgKF9hID0gcGxhY2Vob2xkZXIuY2xhc3NMaXN0KS5hZGQuYXBwbHkoX2EsIHBsYWNlaG9sZGVyQ2xhc3Muc3BsaXQoJyAnKSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcGxhY2Vob2xkZXI7XG4gIH0pO1xuXG4gIC8qIGVzbGludC1lbnYgYnJvd3NlciAqL1xuICAvKipcbiAgICogR2V0IGhlaWdodCBvZiBhbiBlbGVtZW50IGluY2x1ZGluZyBwYWRkaW5nXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnQgYW4gZG9tIGVsZW1lbnRcbiAgICovXG4gIHZhciBnZXRFbGVtZW50SGVpZ2h0ID0gKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICBpZiAoIShlbGVtZW50IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgbXVzdCBwcm92aWRlIGEgdmFsaWQgZG9tIGVsZW1lbnQnKTtcbiAgICAgIH1cbiAgICAgIC8vIGdldCBjYWxjdWxhdGVkIHN0eWxlIG9mIGVsZW1lbnRcbiAgICAgIHZhciBzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpO1xuICAgICAgLy8gZ2V0IG9ubHkgaGVpZ2h0IGlmIGVsZW1lbnQgaGFzIGJveC1zaXppbmc6IGJvcmRlci1ib3ggc3BlY2lmaWVkXG4gICAgICBpZiAoc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnYm94LXNpemluZycpID09PSAnYm9yZGVyLWJveCcpIHtcbiAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnaGVpZ2h0JyksIDEwKTtcbiAgICAgIH1cbiAgICAgIC8vIHBpY2sgYXBwbGljYWJsZSBwcm9wZXJ0aWVzLCBjb252ZXJ0IHRvIGludCBhbmQgcmVkdWNlIGJ5IGFkZGluZ1xuICAgICAgcmV0dXJuIFsnaGVpZ2h0JywgJ3BhZGRpbmctdG9wJywgJ3BhZGRpbmctYm90dG9tJ11cbiAgICAgICAgICAubWFwKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICB2YXIgaW50ID0gcGFyc2VJbnQoc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShrZXkpLCAxMCk7XG4gICAgICAgICAgcmV0dXJuIGlzTmFOKGludCkgPyAwIDogaW50O1xuICAgICAgfSlcbiAgICAgICAgICAucmVkdWNlKGZ1bmN0aW9uIChzdW0sIHZhbHVlKSB7IHJldHVybiBzdW0gKyB2YWx1ZTsgfSk7XG4gIH0pO1xuXG4gIC8qIGVzbGludC1lbnYgYnJvd3NlciAqL1xuICAvKipcbiAgICogR2V0IHdpZHRoIG9mIGFuIGVsZW1lbnQgaW5jbHVkaW5nIHBhZGRpbmdcbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWxlbWVudCBhbiBkb20gZWxlbWVudFxuICAgKi9cbiAgdmFyIGdldEVsZW1lbnRXaWR0aCA9IChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgaWYgKCEoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignWW91IG11c3QgcHJvdmlkZSBhIHZhbGlkIGRvbSBlbGVtZW50Jyk7XG4gICAgICB9XG4gICAgICAvLyBnZXQgY2FsY3VsYXRlZCBzdHlsZSBvZiBlbGVtZW50XG4gICAgICB2YXIgc3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KTtcbiAgICAgIC8vIHBpY2sgYXBwbGljYWJsZSBwcm9wZXJ0aWVzLCBjb252ZXJ0IHRvIGludCBhbmQgcmVkdWNlIGJ5IGFkZGluZ1xuICAgICAgcmV0dXJuIFsnd2lkdGgnLCAncGFkZGluZy1sZWZ0JywgJ3BhZGRpbmctcmlnaHQnXVxuICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgIHZhciBpbnQgPSBwYXJzZUludChzdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKGtleSksIDEwKTtcbiAgICAgICAgICByZXR1cm4gaXNOYU4oaW50KSA/IDAgOiBpbnQ7XG4gICAgICB9KVxuICAgICAgICAgIC5yZWR1Y2UoZnVuY3Rpb24gKHN1bSwgdmFsdWUpIHsgcmV0dXJuIHN1bSArIHZhbHVlOyB9KTtcbiAgfSk7XG5cbiAgLyogZXNsaW50LWVudiBicm93c2VyICovXG4gIC8qKlxuICAgKiBnZXQgaGFuZGxlIG9yIHJldHVybiBpdGVtXG4gICAqIEBwYXJhbSB7QXJyYXk8SFRNTEVsZW1lbnQ+fSBpdGVtc1xuICAgKiBAcGFyYW0ge3N0cmluZ30gc2VsZWN0b3JcbiAgICovXG4gIHZhciBnZXRIYW5kbGVzID0gKGZ1bmN0aW9uIChpdGVtcywgc2VsZWN0b3IpIHtcbiAgICAgIGlmICghKGl0ZW1zIGluc3RhbmNlb2YgQXJyYXkpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgbXVzdCBwcm92aWRlIGEgQXJyYXkgb2YgSFRNTEVsZW1lbnRzIHRvIGJlIGZpbHRlcmVkLicpO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiBzZWxlY3RvciAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICByZXR1cm4gaXRlbXM7XG4gICAgICB9XG4gICAgICByZXR1cm4gaXRlbXNcbiAgICAgICAgICAvLyByZW1vdmUgaXRlbXMgd2l0aG91dCBoYW5kbGUgZnJvbSBhcnJheVxuICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICByZXR1cm4gaXRlbS5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50IHx8XG4gICAgICAgICAgICAgIChpdGVtLnNoYWRvd1Jvb3QgJiYgaXRlbS5zaGFkb3dSb290LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpO1xuICAgICAgfSlcbiAgICAgICAgICAvLyByZXBsYWNlIGl0ZW0gd2l0aCBoYW5kbGUgaW4gYXJyYXlcbiAgICAgICAgICAubWFwKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgcmV0dXJuIGl0ZW0ucXVlcnlTZWxlY3RvcihzZWxlY3RvcikgfHwgKGl0ZW0uc2hhZG93Um9vdCAmJiBpdGVtLnNoYWRvd1Jvb3QucXVlcnlTZWxlY3RvcihzZWxlY3RvcikpO1xuICAgICAgfSk7XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuICAgKiBAcmV0dXJucyB7SFRNTEVsZW1lbnR9XG4gICAqL1xuICB2YXIgZ2V0RXZlbnRUYXJnZXQgPSAoZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICByZXR1cm4gKGV2ZW50LmNvbXBvc2VkUGF0aCAmJiBldmVudC5jb21wb3NlZFBhdGgoKVswXSkgfHwgZXZlbnQudGFyZ2V0O1xuICB9KTtcblxuICAvKiBlc2xpbnQtZW52IGJyb3dzZXIgKi9cbiAgLyoqXG4gICAqIGRlZmF1bHREcmFnSW1hZ2UgcmV0dXJucyB0aGUgY3VycmVudCBpdGVtIGFzIGRyYWdnZWQgaW1hZ2VcbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZHJhZ2dlZEVsZW1lbnQgLSB0aGUgaXRlbSB0aGF0IHRoZSB1c2VyIGRyYWdzXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBlbGVtZW50T2Zmc2V0IC0gYW4gb2JqZWN0IHdpdGggdGhlIG9mZnNldHMgdG9wLCBsZWZ0LCByaWdodCAmIGJvdHRvbVxuICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudCAtIHRoZSBvcmlnaW5hbCBkcmFnIGV2ZW50IG9iamVjdFxuICAgKiBAcmV0dXJuIHtvYmplY3R9IHdpdGggZWxlbWVudCwgcG9zWCBhbmQgcG9zWSBwcm9wZXJ0aWVzXG4gICAqL1xuICB2YXIgZGVmYXVsdERyYWdJbWFnZSA9IGZ1bmN0aW9uIChkcmFnZ2VkRWxlbWVudCwgZWxlbWVudE9mZnNldCwgZXZlbnQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgICAgZWxlbWVudDogZHJhZ2dlZEVsZW1lbnQsXG4gICAgICAgICAgcG9zWDogZXZlbnQucGFnZVggLSBlbGVtZW50T2Zmc2V0LmxlZnQsXG4gICAgICAgICAgcG9zWTogZXZlbnQucGFnZVkgLSBlbGVtZW50T2Zmc2V0LnRvcFxuICAgICAgfTtcbiAgfTtcbiAgLyoqXG4gICAqIGF0dGFjaGVzIGFuIGVsZW1lbnQgYXMgdGhlIGRyYWcgaW1hZ2UgdG8gYW4gZXZlbnRcbiAgICogQHBhcmFtIHtFdmVudH0gZXZlbnQgLSB0aGUgb3JpZ2luYWwgZHJhZyBldmVudCBvYmplY3RcbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZHJhZ2dlZEVsZW1lbnQgLSB0aGUgaXRlbSB0aGF0IHRoZSB1c2VyIGRyYWdzXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGN1c3RvbURyYWdJbWFnZSAtIGZ1bmN0aW9uIHRvIGNyZWF0ZSBhIGN1c3RvbSBkcmFnSW1hZ2VcbiAgICogQHJldHVybiB2b2lkXG4gICAqL1xuICB2YXIgc2V0RHJhZ0ltYWdlID0gKGZ1bmN0aW9uIChldmVudCwgZHJhZ2dlZEVsZW1lbnQsIGN1c3RvbURyYWdJbWFnZSkge1xuICAgICAgLy8gY2hlY2sgaWYgZXZlbnQgaXMgcHJvdmlkZWRcbiAgICAgIGlmICghKGV2ZW50IGluc3RhbmNlb2YgRXZlbnQpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzZXREcmFnSW1hZ2UgcmVxdWlyZXMgYSBEcmFnRXZlbnQgYXMgdGhlIGZpcnN0IGFyZ3VtZW50LicpO1xuICAgICAgfVxuICAgICAgLy8gY2hlY2sgaWYgZHJhZ2dlZEVsZW1lbnQgaXMgcHJvdmlkZWRcbiAgICAgIGlmICghKGRyYWdnZWRFbGVtZW50IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzZXREcmFnSW1hZ2UgcmVxdWlyZXMgdGhlIGRyYWdnZWQgZWxlbWVudCBhcyB0aGUgc2Vjb25kIGFyZ3VtZW50LicpO1xuICAgICAgfVxuICAgICAgLy8gc2V0IGRlZmF1bHQgZnVuY3Rpb24gb2Ygbm9uZSBwcm92aWRlZFxuICAgICAgaWYgKCFjdXN0b21EcmFnSW1hZ2UpIHtcbiAgICAgICAgICBjdXN0b21EcmFnSW1hZ2UgPSBkZWZhdWx0RHJhZ0ltYWdlO1xuICAgICAgfVxuICAgICAgLy8gY2hlY2sgaWYgc2V0RHJhZ0ltYWdlIG1ldGhvZCBpcyBhdmFpbGFibGVcbiAgICAgIGlmIChldmVudC5kYXRhVHJhbnNmZXIgJiYgZXZlbnQuZGF0YVRyYW5zZmVyLnNldERyYWdJbWFnZSkge1xuICAgICAgICAgIC8vIGdldCB0aGUgZWxlbWVudHMgb2Zmc2V0XG4gICAgICAgICAgdmFyIGVsZW1lbnRPZmZzZXQgPSBvZmZzZXQoZHJhZ2dlZEVsZW1lbnQpO1xuICAgICAgICAgIC8vIGdldCB0aGUgZHJhZ0ltYWdlXG4gICAgICAgICAgdmFyIGRyYWdJbWFnZSA9IGN1c3RvbURyYWdJbWFnZShkcmFnZ2VkRWxlbWVudCwgZWxlbWVudE9mZnNldCwgZXZlbnQpO1xuICAgICAgICAgIC8vIGNoZWNrIGlmIGN1c3RvbSBmdW5jdGlvbiByZXR1cm5zIGNvcnJlY3QgdmFsdWVzXG4gICAgICAgICAgaWYgKCEoZHJhZ0ltYWdlLmVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkgfHwgdHlwZW9mIGRyYWdJbWFnZS5wb3NYICE9PSAnbnVtYmVyJyB8fCB0eXBlb2YgZHJhZ0ltYWdlLnBvc1kgIT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIGN1c3RvbURyYWdJbWFnZSBmdW5jdGlvbiB5b3UgcHJvdmlkZWQgbXVzdCByZXR1cm4gYW5kIG9iamVjdCB3aXRoIHRoZSBwcm9wZXJ0aWVzIGVsZW1lbnRbc3RyaW5nXSwgcG9zWFtpbnRlZ2VyXSwgcG9zWVtpbnRlZ2VyXS4nKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gbmVlZHMgdG8gYmUgc2V0IGZvciBIVE1MNSBkcmFnICYgZHJvcCB0byB3b3JrXG4gICAgICAgICAgZXZlbnQuZGF0YVRyYW5zZmVyLmVmZmVjdEFsbG93ZWQgPSAnY29weU1vdmUnO1xuICAgICAgICAgIC8vIEZpcmVmb3ggcmVxdWlyZXMgaXQgdG8gdXNlIHRoZSBldmVudCB0YXJnZXQncyBpZCBmb3IgdGhlIGRhdGFcbiAgICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIuc2V0RGF0YSgndGV4dC9wbGFpbicsIGdldEV2ZW50VGFyZ2V0KGV2ZW50KS5pZCk7XG4gICAgICAgICAgLy8gc2V0IHRoZSBkcmFnIGltYWdlIG9uIHRoZSBldmVudFxuICAgICAgICAgIGV2ZW50LmRhdGFUcmFuc2Zlci5zZXREcmFnSW1hZ2UoZHJhZ0ltYWdlLmVsZW1lbnQsIGRyYWdJbWFnZS5wb3NYLCBkcmFnSW1hZ2UucG9zWSk7XG4gICAgICB9XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBjdXJMaXN0IGFjY2VwdHMgaXRlbXMgZnJvbSBkZXN0TGlzdFxuICAgKiBAcGFyYW0ge3NvcnRhYmxlfSBkZXN0aW5hdGlvbiB0aGUgY29udGFpbmVyIGFuIGl0ZW0gaXMgbW92ZSB0b1xuICAgKiBAcGFyYW0ge3NvcnRhYmxlfSBvcmlnaW4gdGhlIGNvbnRhaW5lciBhbiBpdGVtIGNvbWVzIGZyb21cbiAgICovXG4gIHZhciBsaXN0c0Nvbm5lY3RlZCA9IChmdW5jdGlvbiAoZGVzdGluYXRpb24sIG9yaWdpbikge1xuICAgICAgLy8gY2hlY2sgaWYgdmFsaWQgc29ydGFibGVcbiAgICAgIGlmIChkZXN0aW5hdGlvbi5pc1NvcnRhYmxlID09PSB0cnVlKSB7XG4gICAgICAgICAgdmFyIGFjY2VwdEZyb20gPSBzdG9yZShkZXN0aW5hdGlvbikuZ2V0Q29uZmlnKCdhY2NlcHRGcm9tJyk7XG4gICAgICAgICAgLy8gY2hlY2sgaWYgYWNjZXB0RnJvbSBpcyB2YWxpZFxuICAgICAgICAgIGlmIChhY2NlcHRGcm9tICE9PSBudWxsICYmIGFjY2VwdEZyb20gIT09IGZhbHNlICYmIHR5cGVvZiBhY2NlcHRGcm9tICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0hUTUw1U29ydGFibGU6IFdyb25nIGFyZ3VtZW50LCBcImFjY2VwdEZyb21cIiBtdXN0IGJlIFwibnVsbFwiLCBcImZhbHNlXCIsIG9yIGEgdmFsaWQgc2VsZWN0b3Igc3RyaW5nLicpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoYWNjZXB0RnJvbSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICByZXR1cm4gYWNjZXB0RnJvbSAhPT0gZmFsc2UgJiYgYWNjZXB0RnJvbS5zcGxpdCgnLCcpLmZpbHRlcihmdW5jdGlvbiAoc2VsKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gc2VsLmxlbmd0aCA+IDAgJiYgb3JpZ2luLm1hdGNoZXMoc2VsKTtcbiAgICAgICAgICAgICAgfSkubGVuZ3RoID4gMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gZHJvcCBpbiBzYW1lIGxpc3RcbiAgICAgICAgICBpZiAoZGVzdGluYXRpb24gPT09IG9yaWdpbikge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gY2hlY2sgaWYgbGlzdHMgYXJlIGNvbm5lY3RlZCB3aXRoIGNvbm5lY3RXaXRoXG4gICAgICAgICAgaWYgKHN0b3JlKGRlc3RpbmF0aW9uKS5nZXRDb25maWcoJ2Nvbm5lY3RXaXRoJykgIT09IHVuZGVmaW5lZCAmJiBzdG9yZShkZXN0aW5hdGlvbikuZ2V0Q29uZmlnKCdjb25uZWN0V2l0aCcpICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgIHJldHVybiBzdG9yZShkZXN0aW5hdGlvbikuZ2V0Q29uZmlnKCdjb25uZWN0V2l0aCcpID09PSBzdG9yZShvcmlnaW4pLmdldENvbmZpZygnY29ubmVjdFdpdGgnKTtcbiAgICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBkZWZhdWx0IGNvbmZpZ3VyYXRpb25zXG4gICAqL1xuICB2YXIgZGVmYXVsdENvbmZpZ3VyYXRpb24gPSB7XG4gICAgICBpdGVtczogbnVsbCxcbiAgICAgIC8vIGRlcHJlY2F0ZWRcbiAgICAgIGNvbm5lY3RXaXRoOiBudWxsLFxuICAgICAgLy8gZGVwcmVjYXRlZFxuICAgICAgZGlzYWJsZUlFRml4OiBudWxsLFxuICAgICAgYWNjZXB0RnJvbTogbnVsbCxcbiAgICAgIGNvcHk6IGZhbHNlLFxuICAgICAgcGxhY2Vob2xkZXI6IG51bGwsXG4gICAgICBwbGFjZWhvbGRlckNsYXNzOiAnc29ydGFibGUtcGxhY2Vob2xkZXInLFxuICAgICAgZHJhZ2dpbmdDbGFzczogJ3NvcnRhYmxlLWRyYWdnaW5nJyxcbiAgICAgIGhvdmVyQ2xhc3M6IGZhbHNlLFxuICAgICAgZHJvcFRhcmdldENvbnRhaW5lckNsYXNzOiBmYWxzZSxcbiAgICAgIGRlYm91bmNlOiAwLFxuICAgICAgdGhyb3R0bGVUaW1lOiAxMDAsXG4gICAgICBtYXhJdGVtczogMCxcbiAgICAgIGl0ZW1TZXJpYWxpemVyOiB1bmRlZmluZWQsXG4gICAgICBjb250YWluZXJTZXJpYWxpemVyOiB1bmRlZmluZWQsXG4gICAgICBjdXN0b21EcmFnSW1hZ2U6IG51bGwsXG4gICAgICBvcmllbnRhdGlvbjogJ3ZlcnRpY2FsJ1xuICB9O1xuXG4gIC8qKlxuICAgKiBtYWtlIHN1cmUgYSBmdW5jdGlvbiBpcyBvbmx5IGNhbGxlZCBvbmNlIHdpdGhpbiB0aGUgZ2l2ZW4gYW1vdW50IG9mIHRpbWVcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gdGhlIGZ1bmN0aW9uIHRvIHRocm90dGxlXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB0aHJlc2hvbGQgdGltZSBsaW1pdCBmb3IgdGhyb3R0bGluZ1xuICAgKi9cbiAgLy8gbXVzdCB1c2UgZnVuY3Rpb24gdG8ga2VlcCB0aGlzIGNvbnRleHRcbiAgZnVuY3Rpb24gdGhyb3R0bGUgKGZuLCB0aHJlc2hvbGQpIHtcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICBpZiAodGhyZXNob2xkID09PSB2b2lkIDApIHsgdGhyZXNob2xkID0gMjUwOyB9XG4gICAgICAvLyBjaGVjayBmdW5jdGlvblxuICAgICAgaWYgKHR5cGVvZiBmbiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignWW91IG11c3QgcHJvdmlkZSBhIGZ1bmN0aW9uIGFzIHRoZSBmaXJzdCBhcmd1bWVudCBmb3IgdGhyb3R0bGUuJyk7XG4gICAgICB9XG4gICAgICAvLyBjaGVjayB0aHJlc2hvbGRcbiAgICAgIGlmICh0eXBlb2YgdGhyZXNob2xkICE9PSAnbnVtYmVyJykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignWW91IG11c3QgcHJvdmlkZSBhIG51bWJlciBhcyB0aGUgc2Vjb25kIGFyZ3VtZW50IGZvciB0aHJvdHRsZS4nKTtcbiAgICAgIH1cbiAgICAgIHZhciBsYXN0RXZlbnRUaW1lc3RhbXAgPSBudWxsO1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIG5vdyA9IERhdGUubm93KCk7XG4gICAgICAgICAgaWYgKGxhc3RFdmVudFRpbWVzdGFtcCA9PT0gbnVsbCB8fCBub3cgLSBsYXN0RXZlbnRUaW1lc3RhbXAgPj0gdGhyZXNob2xkKSB7XG4gICAgICAgICAgICAgIGxhc3RFdmVudFRpbWVzdGFtcCA9IG5vdztcbiAgICAgICAgICAgICAgZm4uYXBwbHkoX3RoaXMsIGFyZ3MpO1xuICAgICAgICAgIH1cbiAgICAgIH07XG4gIH1cblxuICAvKiBlc2xpbnQtZW52IGJyb3dzZXIgKi9cbiAgLyoqXG4gICAqIGVuYWJsZSBvciBkaXNhYmxlIGhvdmVyQ2xhc3Mgb24gbW91c2VlbnRlci9sZWF2ZSBpZiBjb250YWluZXIgSXRlbXNcbiAgICogQHBhcmFtIHtzb3J0YWJsZX0gc29ydGFibGVDb250YWluZXIgYSB2YWxpZCBzb3J0YWJsZUNvbnRhaW5lclxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGVuYWJsZSBlbmFibGUgb3IgZGlzYWJsZSBldmVudFxuICAgKi9cbiAgdmFyIGVuYWJsZUhvdmVyQ2xhc3MgPSAoZnVuY3Rpb24gKHNvcnRhYmxlQ29udGFpbmVyLCBlbmFibGUpIHtcbiAgICAgIGlmICh0eXBlb2Ygc3RvcmUoc29ydGFibGVDb250YWluZXIpLmdldENvbmZpZygnaG92ZXJDbGFzcycpID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIHZhciBob3ZlckNsYXNzZXNfMSA9IHN0b3JlKHNvcnRhYmxlQ29udGFpbmVyKS5nZXRDb25maWcoJ2hvdmVyQ2xhc3MnKS5zcGxpdCgnICcpO1xuICAgICAgICAgIC8vIGFkZCBjbGFzcyBvbiBob3ZlclxuICAgICAgICAgIGlmIChlbmFibGUgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihzb3J0YWJsZUNvbnRhaW5lciwgJ21vdXNlbW92ZScsIHRocm90dGxlKGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgb2Ygbm8gbW91c2UgYnV0dG9uIHdhcyBwcmVzc2VkIHdoZW4gbW91c2Vtb3ZlIHN0YXJ0ZWQgPT0gbm8gZHJhZ1xuICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmJ1dHRvbnMgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXIoc29ydGFibGVDb250YWluZXIuY2hpbGRyZW4sIHN0b3JlKHNvcnRhYmxlQ29udGFpbmVyKS5nZXRDb25maWcoJ2l0ZW1zJykpLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT09IGV2ZW50LnRhcmdldCB8fCBpdGVtLmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfYSA9IGl0ZW0uY2xhc3NMaXN0KS5hZGQuYXBwbHkoX2EsIGhvdmVyQ2xhc3Nlc18xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfYiA9IGl0ZW0uY2xhc3NMaXN0KS5yZW1vdmUuYXBwbHkoX2IsIGhvdmVyQ2xhc3Nlc18xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LCBzdG9yZShzb3J0YWJsZUNvbnRhaW5lcikuZ2V0Q29uZmlnKCd0aHJvdHRsZVRpbWUnKSkpO1xuICAgICAgICAgICAgICAvLyByZW1vdmUgY2xhc3Mgb24gbGVhdmVcbiAgICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihzb3J0YWJsZUNvbnRhaW5lciwgJ21vdXNlbGVhdmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICBmaWx0ZXIoc29ydGFibGVDb250YWluZXIuY2hpbGRyZW4sIHN0b3JlKHNvcnRhYmxlQ29udGFpbmVyKS5nZXRDb25maWcoJ2l0ZW1zJykpLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICAgICAgICAgICAgKF9hID0gaXRlbS5jbGFzc0xpc3QpLnJlbW92ZS5hcHBseShfYSwgaG92ZXJDbGFzc2VzXzEpO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAvLyByZW1vdmUgZXZlbnRzXG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICByZW1vdmVFdmVudExpc3RlbmVyKHNvcnRhYmxlQ29udGFpbmVyLCAnbW91c2Vtb3ZlJyk7XG4gICAgICAgICAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIoc29ydGFibGVDb250YWluZXIsICdtb3VzZWxlYXZlJyk7XG4gICAgICAgICAgfVxuICAgICAgfVxuICB9KTtcblxuICAvKiBlc2xpbnQtZW52IGJyb3dzZXIgKi9cbiAgLypcbiAgICogdmFyaWFibGVzIGdsb2JhbCB0byB0aGUgcGx1Z2luXG4gICAqL1xuICB2YXIgZHJhZ2dpbmc7XG4gIHZhciBkcmFnZ2luZ0hlaWdodDtcbiAgdmFyIGRyYWdnaW5nV2lkdGg7XG4gIC8qXG4gICAqIEtlZXBzIHRyYWNrIG9mIHRoZSBpbml0aWFseSBzZWxlY3RlZCBsaXN0LCB3aGVyZSAnZHJhZ3N0YXJ0JyBldmVudCB3YXMgdHJpZ2dlcmVkXG4gICAqIEl0IGFsbG93cyB1cyB0byBtb3ZlIHRoZSBkYXRhIGluIGJldHdlZW4gaW5kaXZpZHVhbCBTb3J0YWJsZSBMaXN0IGluc3RhbmNlc1xuICAgKi9cbiAgLy8gT3JpZ2luIExpc3QgLSBkYXRhIGZyb20gYmVmb3JlIGFueSBpdGVtIHdhcyBjaGFuZ2VkXG4gIHZhciBvcmlnaW5Db250YWluZXI7XG4gIHZhciBvcmlnaW5JbmRleDtcbiAgdmFyIG9yaWdpbkVsZW1lbnRJbmRleDtcbiAgdmFyIG9yaWdpbkl0ZW1zQmVmb3JlVXBkYXRlO1xuICAvLyBQcmV2aW91cyBTb3J0YWJsZSBDb250YWluZXIgLSB3ZSBkaXNwYXRjaCBhcyBzb3J0ZW50ZXIgZXZlbnQgd2hlbiBhXG4gIC8vIGRyYWdnZWQgaXRlbSBlbnRlcnMgYSBzb3J0YWJsZUNvbnRhaW5lciBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgdmFyIHByZXZpb3VzQ29udGFpbmVyO1xuICAvLyBEZXN0aW5hdGlvbiBMaXN0IC0gZGF0YSBmcm9tIGJlZm9yZSBhbnkgaXRlbSB3YXMgY2hhbmdlZFxuICB2YXIgZGVzdGluYXRpb25JdGVtc0JlZm9yZVVwZGF0ZTtcbiAgLyoqXG4gICAqIHJlbW92ZSBldmVudCBoYW5kbGVycyBmcm9tIGl0ZW1zXG4gICAqIEBwYXJhbSB7QXJyYXl8Tm9kZUxpc3R9IGl0ZW1zXG4gICAqL1xuICB2YXIgcmVtb3ZlSXRlbUV2ZW50cyA9IGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihpdGVtcywgJ2RyYWdzdGFydCcpO1xuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihpdGVtcywgJ2RyYWdlbmQnKTtcbiAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIoaXRlbXMsICdkcmFnb3ZlcicpO1xuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihpdGVtcywgJ2RyYWdlbnRlcicpO1xuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihpdGVtcywgJ2Ryb3AnKTtcbiAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIoaXRlbXMsICdtb3VzZWVudGVyJyk7XG4gICAgICByZW1vdmVFdmVudExpc3RlbmVyKGl0ZW1zLCAnbW91c2VsZWF2ZScpO1xuICB9O1xuICAvLyBSZW1vdmUgY29udGFpbmVyIGV2ZW50c1xuICB2YXIgcmVtb3ZlQ29udGFpbmVyRXZlbnRzID0gZnVuY3Rpb24gKG9yaWdpbkNvbnRhaW5lciwgcHJldmlvdXNDb250YWluZXIpIHtcbiAgICAgIGlmIChvcmlnaW5Db250YWluZXIpIHtcbiAgICAgICAgICByZW1vdmVFdmVudExpc3RlbmVyKG9yaWdpbkNvbnRhaW5lciwgJ2RyYWdsZWF2ZScpO1xuICAgICAgfVxuICAgICAgaWYgKHByZXZpb3VzQ29udGFpbmVyICYmIChwcmV2aW91c0NvbnRhaW5lciAhPT0gb3JpZ2luQ29udGFpbmVyKSkge1xuICAgICAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIocHJldmlvdXNDb250YWluZXIsICdkcmFnbGVhdmUnKTtcbiAgICAgIH1cbiAgfTtcbiAgLyoqXG4gICAqIGdldERyYWdnaW5nIHJldHVybnMgdGhlIGN1cnJlbnQgZWxlbWVudCB0byBkcmFnIG9yXG4gICAqIGEgY29weSBvZiB0aGUgZWxlbWVudC5cbiAgICogSXMgQ29weSBBY3RpdmUgZm9yIHNvcnRhYmxlXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGRyYWdnZWRJdGVtIC0gdGhlIGl0ZW0gdGhhdCB0aGUgdXNlciBkcmFnc1xuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBzb3J0YWJsZSBhIHNpbmdsZSBzb3J0YWJsZVxuICAgKi9cbiAgdmFyIGdldERyYWdnaW5nID0gZnVuY3Rpb24gKGRyYWdnZWRJdGVtLCBzb3J0YWJsZSkge1xuICAgICAgdmFyIGRpdGVtID0gZHJhZ2dlZEl0ZW07XG4gICAgICBpZiAoc3RvcmUoc29ydGFibGUpLmdldENvbmZpZygnY29weScpID09PSB0cnVlKSB7XG4gICAgICAgICAgZGl0ZW0gPSBkcmFnZ2VkSXRlbS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICAgICAgYWRkQXR0cmlidXRlKGRpdGVtLCAnYXJpYS1jb3BpZWQnLCAndHJ1ZScpO1xuICAgICAgICAgIGRyYWdnZWRJdGVtLnBhcmVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoZGl0ZW0pO1xuICAgICAgICAgIGRpdGVtLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgZGl0ZW0ub2xkRGlzcGxheSA9IGRyYWdnZWRJdGVtLnN0eWxlLmRpc3BsYXk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZGl0ZW07XG4gIH07XG4gIC8qKlxuICAgKiBSZW1vdmUgZGF0YSBmcm9tIHNvcnRhYmxlXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHNvcnRhYmxlIGEgc2luZ2xlIHNvcnRhYmxlXG4gICAqL1xuICB2YXIgcmVtb3ZlU29ydGFibGVEYXRhID0gZnVuY3Rpb24gKHNvcnRhYmxlKSB7XG4gICAgICByZW1vdmVEYXRhKHNvcnRhYmxlKTtcbiAgICAgIHJlbW92ZUF0dHJpYnV0ZShzb3J0YWJsZSwgJ2FyaWEtZHJvcGVmZmVjdCcpO1xuICB9O1xuICAvKipcbiAgICogUmVtb3ZlIGRhdGEgZnJvbSBpdGVtc1xuICAgKiBAcGFyYW0ge0FycmF5PEhUTUxFbGVtZW50PnxIVE1MRWxlbWVudH0gaXRlbXNcbiAgICovXG4gIHZhciByZW1vdmVJdGVtRGF0YSA9IGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgcmVtb3ZlQXR0cmlidXRlKGl0ZW1zLCAnYXJpYS1ncmFiYmVkJyk7XG4gICAgICByZW1vdmVBdHRyaWJ1dGUoaXRlbXMsICdhcmlhLWNvcGllZCcpO1xuICAgICAgcmVtb3ZlQXR0cmlidXRlKGl0ZW1zLCAnZHJhZ2dhYmxlJyk7XG4gICAgICByZW1vdmVBdHRyaWJ1dGUoaXRlbXMsICdyb2xlJyk7XG4gIH07XG4gIC8qKlxuICAgKiBmaW5kIHNvcnRhYmxlIGZyb20gZWxlbWVudC4gdHJhdmVscyB1cCBwYXJlbnQgZWxlbWVudCB1bnRpbCBmb3VuZCBvciBudWxsLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBlbGVtZW50IGEgc2luZ2xlIHNvcnRhYmxlXG4gICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50IC0gdGhlIGN1cnJlbnQgZXZlbnQuIFdlIG5lZWQgdG8gcGFzcyBpdCB0byBiZSBhYmxlIHRvXG4gICAqIGZpbmQgU29ydGFibGUgd2hpdGggc2hhZG93Um9vdCAoZG9jdW1lbnQgZnJhZ21lbnQgaGFzIG5vIHBhcmVudClcbiAgICovXG4gIGZ1bmN0aW9uIGZpbmRTb3J0YWJsZShlbGVtZW50LCBldmVudCkge1xuICAgICAgaWYgKGV2ZW50LmNvbXBvc2VkUGF0aCkge1xuICAgICAgICAgIHJldHVybiBldmVudC5jb21wb3NlZFBhdGgoKS5maW5kKGZ1bmN0aW9uIChlbCkgeyByZXR1cm4gZWwuaXNTb3J0YWJsZTsgfSk7XG4gICAgICB9XG4gICAgICB3aGlsZSAoZWxlbWVudC5pc1NvcnRhYmxlICE9PSB0cnVlKSB7XG4gICAgICAgICAgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBlbGVtZW50O1xuICB9XG4gIC8qKlxuICAgKiBEcmFnZ2luZyBldmVudCBpcyBvbiB0aGUgc29ydGFibGUgZWxlbWVudC4gZmluZHMgdGhlIHRvcCBjaGlsZCB0aGF0XG4gICAqIGNvbnRhaW5zIHRoZSBlbGVtZW50LlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBzb3J0YWJsZUVsZW1lbnQgYSBzaW5nbGUgc29ydGFibGVcbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWxlbWVudCBpcyB0aGF0IGJlaW5nIGRyYWdnZWRcbiAgICovXG4gIGZ1bmN0aW9uIGZpbmREcmFnRWxlbWVudChzb3J0YWJsZUVsZW1lbnQsIGVsZW1lbnQpIHtcbiAgICAgIHZhciBvcHRpb25zID0gYWRkRGF0YShzb3J0YWJsZUVsZW1lbnQsICdvcHRzJyk7XG4gICAgICB2YXIgaXRlbXMgPSBmaWx0ZXIoc29ydGFibGVFbGVtZW50LmNoaWxkcmVuLCBvcHRpb25zLml0ZW1zKTtcbiAgICAgIHZhciBpdGVtbGlzdCA9IGl0ZW1zLmZpbHRlcihmdW5jdGlvbiAoZWxlKSB7XG4gICAgICAgICAgcmV0dXJuIGVsZS5jb250YWlucyhlbGVtZW50KSB8fCAoZWxlLnNoYWRvd1Jvb3QgJiYgZWxlLnNoYWRvd1Jvb3QuY29udGFpbnMoZWxlbWVudCkpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gaXRlbWxpc3QubGVuZ3RoID4gMCA/IGl0ZW1saXN0WzBdIDogZWxlbWVudDtcbiAgfVxuICAvKipcbiAgICogRGVzdHJveSB0aGUgc29ydGFibGVcbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gc29ydGFibGVFbGVtZW50IGEgc2luZ2xlIHNvcnRhYmxlXG4gICAqL1xuICB2YXIgZGVzdHJveVNvcnRhYmxlID0gZnVuY3Rpb24gKHNvcnRhYmxlRWxlbWVudCkge1xuICAgICAgdmFyIG9wdHMgPSBhZGREYXRhKHNvcnRhYmxlRWxlbWVudCwgJ29wdHMnKSB8fCB7fTtcbiAgICAgIHZhciBpdGVtcyA9IGZpbHRlcihzb3J0YWJsZUVsZW1lbnQuY2hpbGRyZW4sIG9wdHMuaXRlbXMpO1xuICAgICAgdmFyIGhhbmRsZXMgPSBnZXRIYW5kbGVzKGl0ZW1zLCBvcHRzLmhhbmRsZSk7XG4gICAgICAvLyBkaXNhYmxlIGFkZGluZyBob3ZlciBjbGFzc1xuICAgICAgZW5hYmxlSG92ZXJDbGFzcyhzb3J0YWJsZUVsZW1lbnQsIGZhbHNlKTtcbiAgICAgIC8vIHJlbW92ZSBldmVudCBoYW5kbGVycyAmIGRhdGEgZnJvbSBzb3J0YWJsZVxuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihzb3J0YWJsZUVsZW1lbnQsICdkcmFnb3ZlcicpO1xuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihzb3J0YWJsZUVsZW1lbnQsICdkcmFnZW50ZXInKTtcbiAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIoc29ydGFibGVFbGVtZW50LCAnZHJhZ3N0YXJ0Jyk7XG4gICAgICByZW1vdmVFdmVudExpc3RlbmVyKHNvcnRhYmxlRWxlbWVudCwgJ2RyYWdlbmQnKTtcbiAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIoc29ydGFibGVFbGVtZW50LCAnZHJvcCcpO1xuICAgICAgLy8gcmVtb3ZlIGV2ZW50IGRhdGEgZnJvbSBzb3J0YWJsZVxuICAgICAgcmVtb3ZlU29ydGFibGVEYXRhKHNvcnRhYmxlRWxlbWVudCk7XG4gICAgICAvLyByZW1vdmUgZXZlbnQgaGFuZGxlcnMgJiBkYXRhIGZyb20gaXRlbXNcbiAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIoaGFuZGxlcywgJ21vdXNlZG93bicpO1xuICAgICAgcmVtb3ZlSXRlbUV2ZW50cyhpdGVtcyk7XG4gICAgICByZW1vdmVJdGVtRGF0YShpdGVtcyk7XG4gICAgICByZW1vdmVDb250YWluZXJFdmVudHMob3JpZ2luQ29udGFpbmVyLCBwcmV2aW91c0NvbnRhaW5lcik7XG4gICAgICAvLyBjbGVhciBzb3J0YWJsZSBmbGFnXG4gICAgICBzb3J0YWJsZUVsZW1lbnQuaXNTb3J0YWJsZSA9IGZhbHNlO1xuICB9O1xuICAvKipcbiAgICogRW5hYmxlIHRoZSBzb3J0YWJsZVxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBzb3J0YWJsZUVsZW1lbnQgYSBzaW5nbGUgc29ydGFibGVcbiAgICovXG4gIHZhciBlbmFibGVTb3J0YWJsZSA9IGZ1bmN0aW9uIChzb3J0YWJsZUVsZW1lbnQpIHtcbiAgICAgIHZhciBvcHRzID0gYWRkRGF0YShzb3J0YWJsZUVsZW1lbnQsICdvcHRzJyk7XG4gICAgICB2YXIgaXRlbXMgPSBmaWx0ZXIoc29ydGFibGVFbGVtZW50LmNoaWxkcmVuLCBvcHRzLml0ZW1zKTtcbiAgICAgIHZhciBoYW5kbGVzID0gZ2V0SGFuZGxlcyhpdGVtcywgb3B0cy5oYW5kbGUpO1xuICAgICAgYWRkQXR0cmlidXRlKHNvcnRhYmxlRWxlbWVudCwgJ2FyaWEtZHJvcGVmZmVjdCcsICdtb3ZlJyk7XG4gICAgICBhZGREYXRhKHNvcnRhYmxlRWxlbWVudCwgJ19kaXNhYmxlZCcsICdmYWxzZScpO1xuICAgICAgYWRkQXR0cmlidXRlKGhhbmRsZXMsICdkcmFnZ2FibGUnLCAndHJ1ZScpO1xuICAgICAgLy8gZW5hYmxlIGhvdmVyIGNsYXNzXG4gICAgICBlbmFibGVIb3ZlckNsYXNzKHNvcnRhYmxlRWxlbWVudCwgdHJ1ZSk7XG4gICAgICAvLyBAdG9kbzogcmVtb3ZlIHRoaXMgZml4XG4gICAgICAvLyBJRSBGSVggZm9yIGdob3N0XG4gICAgICAvLyBjYW4gYmUgZGlzYWJsZWQgYXMgaXQgaGFzIHRoZSBzaWRlIGVmZmVjdCB0aGF0IG90aGVyIGV2ZW50c1xuICAgICAgLy8gKGUuZy4gY2xpY2spIHdpbGwgYmUgaWdub3JlZFxuICAgICAgaWYgKG9wdHMuZGlzYWJsZUlFRml4ID09PSBmYWxzZSkge1xuICAgICAgICAgIHZhciBzcGFuRWwgPSAoZG9jdW1lbnQgfHwgd2luZG93LmRvY3VtZW50KS5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgICAgaWYgKHR5cGVvZiBzcGFuRWwuZHJhZ0Ryb3AgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihoYW5kbGVzLCAnbW91c2Vkb3duJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1zLmluZGV4T2YodGhpcykgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmFnRHJvcCgpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50RWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoaXRlbXMuaW5kZXhPZihwYXJlbnQpID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50RWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgcGFyZW50LmRyYWdEcm9wKCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgIH1cbiAgfTtcbiAgLyoqXG4gICAqIERpc2FibGUgdGhlIHNvcnRhYmxlXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHNvcnRhYmxlRWxlbWVudCBhIHNpbmdsZSBzb3J0YWJsZVxuICAgKi9cbiAgdmFyIGRpc2FibGVTb3J0YWJsZSA9IGZ1bmN0aW9uIChzb3J0YWJsZUVsZW1lbnQpIHtcbiAgICAgIHZhciBvcHRzID0gYWRkRGF0YShzb3J0YWJsZUVsZW1lbnQsICdvcHRzJyk7XG4gICAgICB2YXIgaXRlbXMgPSBmaWx0ZXIoc29ydGFibGVFbGVtZW50LmNoaWxkcmVuLCBvcHRzLml0ZW1zKTtcbiAgICAgIHZhciBoYW5kbGVzID0gZ2V0SGFuZGxlcyhpdGVtcywgb3B0cy5oYW5kbGUpO1xuICAgICAgYWRkQXR0cmlidXRlKHNvcnRhYmxlRWxlbWVudCwgJ2FyaWEtZHJvcGVmZmVjdCcsICdub25lJyk7XG4gICAgICBhZGREYXRhKHNvcnRhYmxlRWxlbWVudCwgJ19kaXNhYmxlZCcsICd0cnVlJyk7XG4gICAgICBhZGRBdHRyaWJ1dGUoaGFuZGxlcywgJ2RyYWdnYWJsZScsICdmYWxzZScpO1xuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihoYW5kbGVzLCAnbW91c2Vkb3duJyk7XG4gICAgICBlbmFibGVIb3ZlckNsYXNzKHNvcnRhYmxlRWxlbWVudCwgZmFsc2UpO1xuICB9O1xuICAvKipcbiAgICogUmVsb2FkIHRoZSBzb3J0YWJsZVxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBzb3J0YWJsZUVsZW1lbnQgYSBzaW5nbGUgc29ydGFibGVcbiAgICogQGRlc2NyaXB0aW9uIGV2ZW50cyBuZWVkIHRvIGJlIHJlbW92ZWQgdG8gbm90IGJlIGRvdWJsZSBib3VuZFxuICAgKi9cbiAgdmFyIHJlbG9hZFNvcnRhYmxlID0gZnVuY3Rpb24gKHNvcnRhYmxlRWxlbWVudCkge1xuICAgICAgdmFyIG9wdHMgPSBhZGREYXRhKHNvcnRhYmxlRWxlbWVudCwgJ29wdHMnKTtcbiAgICAgIHZhciBpdGVtcyA9IGZpbHRlcihzb3J0YWJsZUVsZW1lbnQuY2hpbGRyZW4sIG9wdHMuaXRlbXMpO1xuICAgICAgdmFyIGhhbmRsZXMgPSBnZXRIYW5kbGVzKGl0ZW1zLCBvcHRzLmhhbmRsZSk7XG4gICAgICBhZGREYXRhKHNvcnRhYmxlRWxlbWVudCwgJ19kaXNhYmxlZCcsICdmYWxzZScpO1xuICAgICAgLy8gcmVtb3ZlIGV2ZW50IGhhbmRsZXJzIGZyb20gaXRlbXNcbiAgICAgIHJlbW92ZUl0ZW1FdmVudHMoaXRlbXMpO1xuICAgICAgcmVtb3ZlQ29udGFpbmVyRXZlbnRzKG9yaWdpbkNvbnRhaW5lciwgcHJldmlvdXNDb250YWluZXIpO1xuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihoYW5kbGVzLCAnbW91c2Vkb3duJyk7XG4gICAgICAvLyByZW1vdmUgZXZlbnQgaGFuZGxlcnMgZnJvbSBzb3J0YWJsZVxuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihzb3J0YWJsZUVsZW1lbnQsICdkcmFnb3ZlcicpO1xuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihzb3J0YWJsZUVsZW1lbnQsICdkcmFnZW50ZXInKTtcbiAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIoc29ydGFibGVFbGVtZW50LCAnZHJvcCcpO1xuICB9O1xuICAvKipcbiAgICogUHVibGljIHNvcnRhYmxlIG9iamVjdFxuICAgKiBAcGFyYW0ge0FycmF5fE5vZGVMaXN0fSBzb3J0YWJsZUVsZW1lbnRzXG4gICAqIEBwYXJhbSB7b2JqZWN0fHN0cmluZ30gb3B0aW9uc3xtZXRob2RcbiAgICovXG4gIGZ1bmN0aW9uIHNvcnRhYmxlKHNvcnRhYmxlRWxlbWVudHMsIG9wdGlvbnMpIHtcbiAgICAgIC8vIGdldCBtZXRob2Qgc3RyaW5nIHRvIHNlZSBpZiBhIG1ldGhvZCBpcyBjYWxsZWRcbiAgICAgIHZhciBtZXRob2QgPSBTdHJpbmcob3B0aW9ucyk7XG4gICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgIC8vIGNoZWNrIGlmIHRoZSB1c2VyIHByb3ZpZGVkIGEgc2VsZWN0b3IgaW5zdGVhZCBvZiBhbiBlbGVtZW50XG4gICAgICBpZiAodHlwZW9mIHNvcnRhYmxlRWxlbWVudHMgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgc29ydGFibGVFbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc29ydGFibGVFbGVtZW50cyk7XG4gICAgICB9XG4gICAgICAvLyBpZiB0aGUgdXNlciBwcm92aWRlZCBhbiBlbGVtZW50LCByZXR1cm4gaXQgaW4gYW4gYXJyYXkgdG8ga2VlcCB0aGUgcmV0dXJuIHZhbHVlIGNvbnNpc3RhbnRcbiAgICAgIGlmIChzb3J0YWJsZUVsZW1lbnRzIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgICBzb3J0YWJsZUVsZW1lbnRzID0gW3NvcnRhYmxlRWxlbWVudHNdO1xuICAgICAgfVxuICAgICAgc29ydGFibGVFbGVtZW50cyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHNvcnRhYmxlRWxlbWVudHMpO1xuICAgICAgaWYgKC9zZXJpYWxpemUvLnRlc3QobWV0aG9kKSkge1xuICAgICAgICAgIHJldHVybiBzb3J0YWJsZUVsZW1lbnRzLm1hcChmdW5jdGlvbiAoc29ydGFibGVDb250YWluZXIpIHtcbiAgICAgICAgICAgICAgdmFyIG9wdHMgPSBhZGREYXRhKHNvcnRhYmxlQ29udGFpbmVyLCAnb3B0cycpO1xuICAgICAgICAgICAgICByZXR1cm4gc2VyaWFsaXplKHNvcnRhYmxlQ29udGFpbmVyLCBvcHRzLml0ZW1TZXJpYWxpemVyLCBvcHRzLmNvbnRhaW5lclNlcmlhbGl6ZXIpO1xuICAgICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgc29ydGFibGVFbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChzb3J0YWJsZUVsZW1lbnQpIHtcbiAgICAgICAgICBpZiAoL2VuYWJsZXxkaXNhYmxlfGRlc3Ryb3kvLnRlc3QobWV0aG9kKSkge1xuICAgICAgICAgICAgICByZXR1cm4gc29ydGFibGVbbWV0aG9kXShzb3J0YWJsZUVsZW1lbnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBsb2cgZGVwcmVjYXRpb25cbiAgICAgICAgICBbJ2Nvbm5lY3RXaXRoJywgJ2Rpc2FibGVJRUZpeCddLmZvckVhY2goZnVuY3Rpb24gKGNvbmZpZ0tleSkge1xuICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9wdGlvbnMsIGNvbmZpZ0tleSkgJiYgb3B0aW9uc1tjb25maWdLZXldICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJIVE1MNVNvcnRhYmxlOiBZb3UgYXJlIHVzaW5nIHRoZSBkZXByZWNhdGVkIGNvbmZpZ3VyYXRpb24gXFxcIlwiICsgY29uZmlnS2V5ICsgXCJcXFwiLiBUaGlzIHdpbGwgYmUgcmVtb3ZlZCBpbiBhbiB1cGNvbWluZyB2ZXJzaW9uLCBtYWtlIHN1cmUgdG8gbWlncmF0ZSB0byB0aGUgbmV3IG9wdGlvbnMgd2hlbiB1cGRhdGluZy5cIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvLyBtZXJnZSBvcHRpb25zIHdpdGggZGVmYXVsdCBvcHRpb25zXG4gICAgICAgICAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRDb25maWd1cmF0aW9uLCBzdG9yZShzb3J0YWJsZUVsZW1lbnQpLmNvbmZpZywgb3B0aW9ucyk7XG4gICAgICAgICAgLy8gaW5pdCBkYXRhIHN0b3JlIGZvciBzb3J0YWJsZVxuICAgICAgICAgIHN0b3JlKHNvcnRhYmxlRWxlbWVudCkuY29uZmlnID0gb3B0aW9ucztcbiAgICAgICAgICAvLyBzZXQgb3B0aW9ucyBvbiBzb3J0YWJsZVxuICAgICAgICAgIGFkZERhdGEoc29ydGFibGVFbGVtZW50LCAnb3B0cycsIG9wdGlvbnMpO1xuICAgICAgICAgIC8vIHByb3BlcnR5IHRvIGRlZmluZSBhcyBzb3J0YWJsZVxuICAgICAgICAgIHNvcnRhYmxlRWxlbWVudC5pc1NvcnRhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAvLyByZXNldCBzb3J0YWJsZVxuICAgICAgICAgIHJlbG9hZFNvcnRhYmxlKHNvcnRhYmxlRWxlbWVudCk7XG4gICAgICAgICAgLy8gaW5pdGlhbGl6ZVxuICAgICAgICAgIHZhciBsaXN0SXRlbXMgPSBmaWx0ZXIoc29ydGFibGVFbGVtZW50LmNoaWxkcmVuLCBvcHRpb25zLml0ZW1zKTtcbiAgICAgICAgICAvLyBjcmVhdGUgZWxlbWVudCBpZiB1c2VyIGRlZmluZWQgYSBwbGFjZWhvbGRlciBlbGVtZW50IGFzIGEgc3RyaW5nXG4gICAgICAgICAgdmFyIGN1c3RvbVBsYWNlaG9sZGVyO1xuICAgICAgICAgIGlmIChvcHRpb25zLnBsYWNlaG9sZGVyICE9PSBudWxsICYmIG9wdGlvbnMucGxhY2Vob2xkZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICB2YXIgdGVtcENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoc29ydGFibGVFbGVtZW50LnRhZ05hbWUpO1xuICAgICAgICAgICAgICBpZiAob3B0aW9ucy5wbGFjZWhvbGRlciBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICB0ZW1wQ29udGFpbmVyLmFwcGVuZENoaWxkKG9wdGlvbnMucGxhY2Vob2xkZXIpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgdGVtcENvbnRhaW5lci5pbm5lckhUTUwgPSBvcHRpb25zLnBsYWNlaG9sZGVyO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGN1c3RvbVBsYWNlaG9sZGVyID0gdGVtcENvbnRhaW5lci5jaGlsZHJlblswXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gYWRkIHBsYWNlaG9sZGVyXG4gICAgICAgICAgc3RvcmUoc29ydGFibGVFbGVtZW50KS5wbGFjZWhvbGRlciA9IG1ha2VQbGFjZWhvbGRlcihzb3J0YWJsZUVsZW1lbnQsIGN1c3RvbVBsYWNlaG9sZGVyLCBvcHRpb25zLnBsYWNlaG9sZGVyQ2xhc3MpO1xuICAgICAgICAgIGFkZERhdGEoc29ydGFibGVFbGVtZW50LCAnaXRlbXMnLCBvcHRpb25zLml0ZW1zKTtcbiAgICAgICAgICBpZiAob3B0aW9ucy5hY2NlcHRGcm9tKSB7XG4gICAgICAgICAgICAgIGFkZERhdGEoc29ydGFibGVFbGVtZW50LCAnYWNjZXB0RnJvbScsIG9wdGlvbnMuYWNjZXB0RnJvbSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKG9wdGlvbnMuY29ubmVjdFdpdGgpIHtcbiAgICAgICAgICAgICAgYWRkRGF0YShzb3J0YWJsZUVsZW1lbnQsICdjb25uZWN0V2l0aCcsIG9wdGlvbnMuY29ubmVjdFdpdGgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbmFibGVTb3J0YWJsZShzb3J0YWJsZUVsZW1lbnQpO1xuICAgICAgICAgIGFkZEF0dHJpYnV0ZShsaXN0SXRlbXMsICdyb2xlJywgJ29wdGlvbicpO1xuICAgICAgICAgIGFkZEF0dHJpYnV0ZShsaXN0SXRlbXMsICdhcmlhLWdyYWJiZWQnLCAnZmFsc2UnKTtcbiAgICAgICAgICAvKlxuICAgICAgICAgICBIYW5kbGUgZHJhZyBldmVudHMgb24gZHJhZ2dhYmxlIGl0ZW1zXG4gICAgICAgICAgIEhhbmRsZSBpcyBzZXQgYXQgdGhlIHNvcnRhYmxlRWxlbWVudCBsZXZlbCBhcyBpdCB3aWxsIGJ1YmJsZSB1cFxuICAgICAgICAgICBmcm9tIHRoZSBpdGVtXG4gICAgICAgICAgICovXG4gICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihzb3J0YWJsZUVsZW1lbnQsICdkcmFnc3RhcnQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAvLyBpZ25vcmUgZHJhZ3N0YXJ0IGV2ZW50c1xuICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZ2V0RXZlbnRUYXJnZXQoZSk7XG4gICAgICAgICAgICAgIGlmICh0YXJnZXQuaXNTb3J0YWJsZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgIGlmICgob3B0aW9ucy5oYW5kbGUgJiYgIXRhcmdldC5tYXRjaGVzKG9wdGlvbnMuaGFuZGxlKSkgfHwgdGFyZ2V0LmdldEF0dHJpYnV0ZSgnZHJhZ2dhYmxlJykgPT09ICdmYWxzZScpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YXIgc29ydGFibGVDb250YWluZXIgPSBmaW5kU29ydGFibGUodGFyZ2V0LCBlKTtcbiAgICAgICAgICAgICAgdmFyIGRyYWdJdGVtID0gZmluZERyYWdFbGVtZW50KHNvcnRhYmxlQ29udGFpbmVyLCB0YXJnZXQpO1xuICAgICAgICAgICAgICAvLyBncmFiIHZhbHVlc1xuICAgICAgICAgICAgICBvcmlnaW5JdGVtc0JlZm9yZVVwZGF0ZSA9IGZpbHRlcihzb3J0YWJsZUNvbnRhaW5lci5jaGlsZHJlbiwgb3B0aW9ucy5pdGVtcyk7XG4gICAgICAgICAgICAgIG9yaWdpbkluZGV4ID0gb3JpZ2luSXRlbXNCZWZvcmVVcGRhdGUuaW5kZXhPZihkcmFnSXRlbSk7XG4gICAgICAgICAgICAgIG9yaWdpbkVsZW1lbnRJbmRleCA9IGdldEluZGV4KGRyYWdJdGVtLCBzb3J0YWJsZUNvbnRhaW5lci5jaGlsZHJlbik7XG4gICAgICAgICAgICAgIG9yaWdpbkNvbnRhaW5lciA9IHNvcnRhYmxlQ29udGFpbmVyO1xuICAgICAgICAgICAgICAvLyBhZGQgdHJhbnNwYXJlbnQgY2xvbmUgb3Igb3RoZXIgZ2hvc3QgdG8gY3Vyc29yXG4gICAgICAgICAgICAgIHNldERyYWdJbWFnZShlLCBkcmFnSXRlbSwgb3B0aW9ucy5jdXN0b21EcmFnSW1hZ2UpO1xuICAgICAgICAgICAgICAvLyBjYWNoZSBzZWxzZWN0aW9uICYgYWRkIGF0dHIgZm9yIGRyYWdnaW5nXG4gICAgICAgICAgICAgIGRyYWdnaW5nSGVpZ2h0ID0gZ2V0RWxlbWVudEhlaWdodChkcmFnSXRlbSk7XG4gICAgICAgICAgICAgIGRyYWdnaW5nV2lkdGggPSBnZXRFbGVtZW50V2lkdGgoZHJhZ0l0ZW0pO1xuICAgICAgICAgICAgICBkcmFnSXRlbS5jbGFzc0xpc3QuYWRkKG9wdGlvbnMuZHJhZ2dpbmdDbGFzcyk7XG4gICAgICAgICAgICAgIGRyYWdnaW5nID0gZ2V0RHJhZ2dpbmcoZHJhZ0l0ZW0sIHNvcnRhYmxlQ29udGFpbmVyKTtcbiAgICAgICAgICAgICAgYWRkQXR0cmlidXRlKGRyYWdnaW5nLCAnYXJpYS1ncmFiYmVkJywgJ3RydWUnKTtcbiAgICAgICAgICAgICAgLy8gZGlzcGF0Y2ggc29ydHN0YXJ0IGV2ZW50IG9uIGVhY2ggZWxlbWVudCBpbiBncm91cFxuICAgICAgICAgICAgICBzb3J0YWJsZUNvbnRhaW5lci5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnc29ydHN0YXJ0Jywge1xuICAgICAgICAgICAgICAgICAgZGV0YWlsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRJbmRleDogb3JpZ2luRWxlbWVudEluZGV4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleDogb3JpZ2luSW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lcjogb3JpZ2luQ29udGFpbmVyXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICBpdGVtOiBkcmFnZ2luZyxcbiAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbFRhcmdldDogdGFyZ2V0XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvKlxuICAgICAgICAgICBXZSBhcmUgY2FwdHVyaW5nIHRhcmdldFNvcnRhYmxlIGJlZm9yZSBtb2RpZmljYXRpb25zIHdpdGggJ2RyYWdlbnRlcicgZXZlbnRcbiAgICAgICAgICAqL1xuICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoc29ydGFibGVFbGVtZW50LCAnZHJhZ2VudGVyJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGdldEV2ZW50VGFyZ2V0KGUpO1xuICAgICAgICAgICAgICB2YXIgc29ydGFibGVDb250YWluZXIgPSBmaW5kU29ydGFibGUodGFyZ2V0LCBlKTtcbiAgICAgICAgICAgICAgaWYgKHNvcnRhYmxlQ29udGFpbmVyICYmIHNvcnRhYmxlQ29udGFpbmVyICE9PSBwcmV2aW91c0NvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgICAgZGVzdGluYXRpb25JdGVtc0JlZm9yZVVwZGF0ZSA9IGZpbHRlcihzb3J0YWJsZUNvbnRhaW5lci5jaGlsZHJlbiwgYWRkRGF0YShzb3J0YWJsZUNvbnRhaW5lciwgJ2l0ZW1zJykpXG4gICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gaXRlbSAhPT0gc3RvcmUoc29ydGFibGVFbGVtZW50KS5wbGFjZWhvbGRlcjsgfSk7XG4gICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5kcm9wVGFyZ2V0Q29udGFpbmVyQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICBzb3J0YWJsZUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKG9wdGlvbnMuZHJvcFRhcmdldENvbnRhaW5lckNsYXNzKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHNvcnRhYmxlQ29udGFpbmVyLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdzb3J0ZW50ZXInLCB7XG4gICAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudEluZGV4OiBvcmlnaW5FbGVtZW50SW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleDogb3JpZ2luSW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXI6IG9yaWdpbkNvbnRhaW5lclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyOiBzb3J0YWJsZUNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zQmVmb3JlVXBkYXRlOiBkZXN0aW5hdGlvbkl0ZW1zQmVmb3JlVXBkYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW06IGRyYWdnaW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbFRhcmdldDogdGFyZ2V0XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihzb3J0YWJsZUNvbnRhaW5lciwgJ2RyYWdsZWF2ZScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogcmVuYW1lIG91dFRhcmdldCB0byBiZSBtb3JlIHNlbGYtZXhwbGFuYXRvcnlcbiAgICAgICAgICAgICAgICAgICAgICAvLyBlLmZyb21FbGVtZW50IGZvciB2ZXJ5IG9sZCBicm93c2Vycywgc2ltaWxhciB0byByZWxhdGVkVGFyZ2V0XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIG91dFRhcmdldCA9IGUucmVsYXRlZFRhcmdldCB8fCBlLmZyb21FbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICAgIGlmICghZS5jdXJyZW50VGFyZ2V0LmNvbnRhaW5zKG91dFRhcmdldCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZHJvcFRhcmdldENvbnRhaW5lckNsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3J0YWJsZUNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKG9wdGlvbnMuZHJvcFRhcmdldENvbnRhaW5lckNsYXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICBzb3J0YWJsZUNvbnRhaW5lci5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnc29ydGxlYXZlJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRJbmRleDogb3JpZ2luRWxlbWVudEluZGV4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleDogb3JpZ2luSW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lcjogc29ydGFibGVDb250YWluZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW06IGRyYWdnaW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsVGFyZ2V0OiB0YXJnZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHByZXZpb3VzQ29udGFpbmVyID0gc29ydGFibGVDb250YWluZXI7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgLypcbiAgICAgICAgICAgKiBEcmFnZW5kIEV2ZW50IC0gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvRXZlbnRzL2RyYWdlbmRcbiAgICAgICAgICAgKiBGaXJlcyBlYWNoIHRpbWUgZHJhZ0V2ZW50IGVuZCwgb3IgRVNDIHByZXNzZWRcbiAgICAgICAgICAgKiBXZSBhcmUgdXNpbmcgaXQgdG8gY2xlYW4gdXAgYW55IGRyYWdnYWJsZSBlbGVtZW50cyBhbmQgcGxhY2Vob2xkZXJzXG4gICAgICAgICAgICovXG4gICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihzb3J0YWJsZUVsZW1lbnQsICdkcmFnZW5kJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgaWYgKCFkcmFnZ2luZykge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGRyYWdnaW5nLmNsYXNzTGlzdC5yZW1vdmUob3B0aW9ucy5kcmFnZ2luZ0NsYXNzKTtcbiAgICAgICAgICAgICAgYWRkQXR0cmlidXRlKGRyYWdnaW5nLCAnYXJpYS1ncmFiYmVkJywgJ2ZhbHNlJyk7XG4gICAgICAgICAgICAgIGlmIChkcmFnZ2luZy5nZXRBdHRyaWJ1dGUoJ2FyaWEtY29waWVkJykgPT09ICd0cnVlJyAmJiBhZGREYXRhKGRyYWdnaW5nLCAnZHJvcHBlZCcpICE9PSAndHJ1ZScpIHtcbiAgICAgICAgICAgICAgICAgIGRyYWdnaW5nLnJlbW92ZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGlmIChkcmFnZ2luZy5vbGREaXNwbGF5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgIGRyYWdnaW5nLnN0eWxlLmRpc3BsYXkgPSBkcmFnZ2luZy5vbGREaXNwbGF5O1xuICAgICAgICAgICAgICAgICAgZGVsZXRlIGRyYWdnaW5nLm9sZERpc3BsYXk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdmFyIHZpc2libGVQbGFjZWhvbGRlciA9IEFycmF5LmZyb20oc3RvcmVzLnZhbHVlcygpKS5tYXAoZnVuY3Rpb24gKGRhdGEpIHsgcmV0dXJuIGRhdGEucGxhY2Vob2xkZXI7IH0pXG4gICAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChwbGFjZWhvbGRlcikgeyByZXR1cm4gcGxhY2Vob2xkZXIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudDsgfSlcbiAgICAgICAgICAgICAgICAgIC5maWx0ZXIoaXNJbkRvbSlbMF07XG4gICAgICAgICAgICAgIGlmICh2aXNpYmxlUGxhY2Vob2xkZXIpIHtcbiAgICAgICAgICAgICAgICAgIHZpc2libGVQbGFjZWhvbGRlci5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvLyBkaXNwYXRjaCBzb3J0c3RhcnQgZXZlbnQgb24gZWFjaCBlbGVtZW50IGluIGdyb3VwXG4gICAgICAgICAgICAgIHNvcnRhYmxlRWxlbWVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnc29ydHN0b3AnLCB7XG4gICAgICAgICAgICAgICAgICBkZXRhaWw6IHtcbiAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudEluZGV4OiBvcmlnaW5FbGVtZW50SW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4OiBvcmlnaW5JbmRleCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyOiBvcmlnaW5Db250YWluZXJcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIGl0ZW06IGRyYWdnaW5nXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgcHJldmlvdXNDb250YWluZXIgPSBudWxsO1xuICAgICAgICAgICAgICBkcmFnZ2luZyA9IG51bGw7XG4gICAgICAgICAgICAgIGRyYWdnaW5nSGVpZ2h0ID0gbnVsbDtcbiAgICAgICAgICAgICAgZHJhZ2dpbmdXaWR0aCA9IG51bGw7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgLypcbiAgICAgICAgICAgKiBEcm9wIEV2ZW50IC0gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvRXZlbnRzL2Ryb3BcbiAgICAgICAgICAgKiBGaXJlcyB3aGVuIHZhbGlkIGRyb3AgdGFyZ2V0IGFyZWEgaXMgaGl0XG4gICAgICAgICAgICovXG4gICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihzb3J0YWJsZUVsZW1lbnQsICdkcm9wJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgaWYgKCFsaXN0c0Nvbm5lY3RlZChzb3J0YWJsZUVsZW1lbnQsIGRyYWdnaW5nLnBhcmVudEVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICBhZGREYXRhKGRyYWdnaW5nLCAnZHJvcHBlZCcsICd0cnVlJyk7XG4gICAgICAgICAgICAgIC8vIGdldCB0aGUgb25lIHBsYWNlaG9sZGVyIHRoYXQgaXMgY3VycmVudGx5IHZpc2libGVcbiAgICAgICAgICAgICAgdmFyIHZpc2libGVQbGFjZWhvbGRlciA9IEFycmF5LmZyb20oc3RvcmVzLnZhbHVlcygpKS5tYXAoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLnBsYWNlaG9sZGVyO1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgLy8gZmlsdGVyIG9ubHkgSFRNTEVsZW1lbnRzXG4gICAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChwbGFjZWhvbGRlcikgeyByZXR1cm4gcGxhY2Vob2xkZXIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudDsgfSlcbiAgICAgICAgICAgICAgICAgIC8vIG9ubHkgZWxlbWVudHMgaW4gRE9NXG4gICAgICAgICAgICAgICAgICAuZmlsdGVyKGlzSW5Eb20pWzBdO1xuICAgICAgICAgICAgICBpZiAodmlzaWJsZVBsYWNlaG9sZGVyKSB7XG4gICAgICAgICAgICAgICAgICB2aXNpYmxlUGxhY2Vob2xkZXIucmVwbGFjZVdpdGgoZHJhZ2dpbmcpO1xuICAgICAgICAgICAgICAgICAgLy8gdG8gYXZvaWQgZmxpY2tlcmluZyByZXN0b3JpbmcgZWxlbWVudCBkaXNwbGF5IGltbWVkaWF0ZWx5IGFmdGVyIHJlcGxhY2luZyBwbGFjZWhvbGRlclxuICAgICAgICAgICAgICAgICAgaWYgKGRyYWdnaW5nLm9sZERpc3BsYXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgIGRyYWdnaW5nLnN0eWxlLmRpc3BsYXkgPSBkcmFnZ2luZy5vbGREaXNwbGF5O1xuICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBkcmFnZ2luZy5vbGREaXNwbGF5O1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBkcm9wcGVkIHZhbHVlIHRvICdmYWxzZScgdG8gZGVsZXRlIGNvcGllZCBkcmFnZ2luZyBhdCB0aGUgdGltZSBvZiAnZHJhZ2VuZCdcbiAgICAgICAgICAgICAgICAgIGFkZERhdGEoZHJhZ2dpbmcsICdkcm9wcGVkJywgJ2ZhbHNlJyk7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICogRmlyZXMgQ3VzdG9tIEV2ZW50IC0gJ3NvcnRzdG9wJ1xuICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgc29ydGFibGVFbGVtZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdzb3J0c3RvcCcsIHtcbiAgICAgICAgICAgICAgICAgIGRldGFpbDoge1xuICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50SW5kZXg6IG9yaWdpbkVsZW1lbnRJbmRleCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg6IG9yaWdpbkluZGV4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXI6IG9yaWdpbkNvbnRhaW5lclxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgaXRlbTogZHJhZ2dpbmdcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICB2YXIgcGxhY2Vob2xkZXIgPSBzdG9yZShzb3J0YWJsZUVsZW1lbnQpLnBsYWNlaG9sZGVyO1xuICAgICAgICAgICAgICB2YXIgb3JpZ2luSXRlbXMgPSBmaWx0ZXIob3JpZ2luQ29udGFpbmVyLmNoaWxkcmVuLCBvcHRpb25zLml0ZW1zKVxuICAgICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gaXRlbSAhPT0gcGxhY2Vob2xkZXI7IH0pO1xuICAgICAgICAgICAgICB2YXIgZGVzdGluYXRpb25Db250YWluZXIgPSB0aGlzLmlzU29ydGFibGUgPT09IHRydWUgPyB0aGlzIDogdGhpcy5wYXJlbnRFbGVtZW50O1xuICAgICAgICAgICAgICB2YXIgZGVzdGluYXRpb25JdGVtcyA9IGZpbHRlcihkZXN0aW5hdGlvbkNvbnRhaW5lci5jaGlsZHJlbiwgYWRkRGF0YShkZXN0aW5hdGlvbkNvbnRhaW5lciwgJ2l0ZW1zJykpXG4gICAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7IHJldHVybiBpdGVtICE9PSBwbGFjZWhvbGRlcjsgfSk7XG4gICAgICAgICAgICAgIHZhciBkZXN0aW5hdGlvbkVsZW1lbnRJbmRleCA9IGdldEluZGV4KGRyYWdnaW5nLCBBcnJheS5mcm9tKGRyYWdnaW5nLnBhcmVudEVsZW1lbnQuY2hpbGRyZW4pXG4gICAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7IHJldHVybiBpdGVtICE9PSBwbGFjZWhvbGRlcjsgfSkpO1xuICAgICAgICAgICAgICB2YXIgZGVzdGluYXRpb25JbmRleCA9IGdldEluZGV4KGRyYWdnaW5nLCBkZXN0aW5hdGlvbkl0ZW1zKTtcbiAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZHJvcFRhcmdldENvbnRhaW5lckNsYXNzKSB7XG4gICAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbkNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKG9wdGlvbnMuZHJvcFRhcmdldENvbnRhaW5lckNsYXNzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgKiBXaGVuIGEgbGlzdCBpdGVtIGNoYW5nZWQgY29udGFpbmVyIGxpc3RzIG9yIGluZGV4IHdpdGhpbiBhIGxpc3RcbiAgICAgICAgICAgICAgICogRmlyZXMgQ3VzdG9tIEV2ZW50IC0gJ3NvcnR1cGRhdGUnXG4gICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICBpZiAob3JpZ2luRWxlbWVudEluZGV4ICE9PSBkZXN0aW5hdGlvbkVsZW1lbnRJbmRleCB8fCBvcmlnaW5Db250YWluZXIgIT09IGRlc3RpbmF0aW9uQ29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgICBzb3J0YWJsZUVsZW1lbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ3NvcnR1cGRhdGUnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudEluZGV4OiBvcmlnaW5FbGVtZW50SW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleDogb3JpZ2luSW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXI6IG9yaWdpbkNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zQmVmb3JlVXBkYXRlOiBvcmlnaW5JdGVtc0JlZm9yZVVwZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zOiBvcmlnaW5JdGVtc1xuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg6IGRlc3RpbmF0aW9uSW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50SW5kZXg6IGRlc3RpbmF0aW9uRWxlbWVudEluZGV4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyOiBkZXN0aW5hdGlvbkNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zQmVmb3JlVXBkYXRlOiBkZXN0aW5hdGlvbkl0ZW1zQmVmb3JlVXBkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IGRlc3RpbmF0aW9uSXRlbXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbTogZHJhZ2dpbmdcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICB2YXIgZGVib3VuY2VkRHJhZ092ZXJFbnRlciA9IGRlYm91bmNlKGZ1bmN0aW9uIChzb3J0YWJsZUVsZW1lbnQsIGVsZW1lbnQsIHBhZ2VYLCBwYWdlWSkge1xuICAgICAgICAgICAgICBpZiAoIWRyYWdnaW5nKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLy8gc2V0IHBsYWNlaG9sZGVyIGhlaWdodCBpZiBmb3JjZVBsYWNlaG9sZGVyU2l6ZSBvcHRpb24gaXMgc2V0XG4gICAgICAgICAgICAgIGlmIChvcHRpb25zLmZvcmNlUGxhY2Vob2xkZXJTaXplKSB7XG4gICAgICAgICAgICAgICAgICBzdG9yZShzb3J0YWJsZUVsZW1lbnQpLnBsYWNlaG9sZGVyLnN0eWxlLmhlaWdodCA9IGRyYWdnaW5nSGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgICAgICAgIHN0b3JlKHNvcnRhYmxlRWxlbWVudCkucGxhY2Vob2xkZXIuc3R5bGUud2lkdGggPSBkcmFnZ2luZ1dpZHRoICsgJ3B4JztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvLyBpZiBlbGVtZW50IHRoZSBkcmFnZ2VkSXRlbSBpcyBkcmFnZ2VkIG9udG8gaXMgd2l0aGluIHRoZSBhcnJheSBvZiBhbGwgZWxlbWVudHMgaW4gbGlzdFxuICAgICAgICAgICAgICAvLyAobm90IG9ubHkgaXRlbXMsIGJ1dCBhbHNvIGRpc2FibGVkLCBldGMuKVxuICAgICAgICAgICAgICBpZiAoQXJyYXkuZnJvbShzb3J0YWJsZUVsZW1lbnQuY2hpbGRyZW4pLmluZGV4T2YoZWxlbWVudCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgdmFyIHRoaXNIZWlnaHQgPSBnZXRFbGVtZW50SGVpZ2h0KGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgdmFyIHRoaXNXaWR0aCA9IGdldEVsZW1lbnRXaWR0aChlbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgIHZhciBwbGFjZWhvbGRlckluZGV4ID0gZ2V0SW5kZXgoc3RvcmUoc29ydGFibGVFbGVtZW50KS5wbGFjZWhvbGRlciwgZWxlbWVudC5wYXJlbnRFbGVtZW50LmNoaWxkcmVuKTtcbiAgICAgICAgICAgICAgICAgIHZhciB0aGlzSW5kZXggPSBnZXRJbmRleChlbGVtZW50LCBlbGVtZW50LnBhcmVudEVsZW1lbnQuY2hpbGRyZW4pO1xuICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgYGVsZW1lbnRgIGlzIGJpZ2dlciB0aGFuIHRoZSBkcmFnZ2FibGUuIElmIGl0IGlzLCB3ZSBoYXZlIHRvIGRlZmluZSBhIGRlYWQgem9uZSB0byBwcmV2ZW50IGZsaWNrZXJpbmdcbiAgICAgICAgICAgICAgICAgIGlmICh0aGlzSGVpZ2h0ID4gZHJhZ2dpbmdIZWlnaHQgfHwgdGhpc1dpZHRoID4gZHJhZ2dpbmdXaWR0aCkge1xuICAgICAgICAgICAgICAgICAgICAgIC8vIERlYWQgem9uZT9cbiAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVhZFpvbmVWZXJ0aWNhbCA9IHRoaXNIZWlnaHQgLSBkcmFnZ2luZ0hlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVhZFpvbmVIb3Jpem9udGFsID0gdGhpc1dpZHRoIC0gZHJhZ2dpbmdXaWR0aDtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0VG9wID0gb2Zmc2V0KGVsZW1lbnQpLnRvcDtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0TGVmdCA9IG9mZnNldChlbGVtZW50KS5sZWZ0O1xuICAgICAgICAgICAgICAgICAgICAgIGlmIChwbGFjZWhvbGRlckluZGV4IDwgdGhpc0luZGV4ICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICgob3B0aW9ucy5vcmllbnRhdGlvbiA9PT0gJ3ZlcnRpY2FsJyAmJiBwYWdlWSA8IG9mZnNldFRvcCkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChvcHRpb25zLm9yaWVudGF0aW9uID09PSAnaG9yaXpvbnRhbCcgJiYgcGFnZVggPCBvZmZzZXRMZWZ0KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICBpZiAocGxhY2Vob2xkZXJJbmRleCA+IHRoaXNJbmRleCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAoKG9wdGlvbnMub3JpZW50YXRpb24gPT09ICd2ZXJ0aWNhbCcgJiYgcGFnZVkgPiBvZmZzZXRUb3AgKyB0aGlzSGVpZ2h0IC0gZGVhZFpvbmVWZXJ0aWNhbCkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChvcHRpb25zLm9yaWVudGF0aW9uID09PSAnaG9yaXpvbnRhbCcgJiYgcGFnZVggPiBvZmZzZXRMZWZ0ICsgdGhpc1dpZHRoIC0gZGVhZFpvbmVIb3Jpem9udGFsKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIGlmIChkcmFnZ2luZy5vbGREaXNwbGF5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICBkcmFnZ2luZy5vbGREaXNwbGF5ID0gZHJhZ2dpbmcuc3R5bGUuZGlzcGxheTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIGlmIChkcmFnZ2luZy5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICBkcmFnZ2luZy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgLy8gVG8gYXZvaWQgZmxpY2tlciwgZGV0ZXJtaW5lIHdoZXJlIHRvIHBvc2l0aW9uIHRoZSBwbGFjZWhvbGRlclxuICAgICAgICAgICAgICAgICAgLy8gYmFzZWQgb24gd2hlcmUgdGhlIG1vdXNlIHBvaW50ZXIgaXMgcmVsYXRpdmUgdG8gdGhlIGVsZW1lbnRzXG4gICAgICAgICAgICAgICAgICAvLyB2ZXJ0aWNhbCBjZW50ZXIuXG4gICAgICAgICAgICAgICAgICB2YXIgcGxhY2VBZnRlciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudE1pZGRsZVZlcnRpY2FsID0gb2Zmc2V0KGVsZW1lbnQpLnRvcCArIGVsZW1lbnQub2Zmc2V0SGVpZ2h0IC8gMjtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudE1pZGRsZUhvcml6b250YWwgPSBvZmZzZXQoZWxlbWVudCkubGVmdCArIGVsZW1lbnQub2Zmc2V0V2lkdGggLyAyO1xuICAgICAgICAgICAgICAgICAgICAgIHBsYWNlQWZ0ZXIgPSAob3B0aW9ucy5vcmllbnRhdGlvbiA9PT0gJ3ZlcnRpY2FsJyAmJiAocGFnZVkgPj0gZWxlbWVudE1pZGRsZVZlcnRpY2FsKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKG9wdGlvbnMub3JpZW50YXRpb24gPT09ICdob3Jpem9udGFsJyAmJiAocGFnZVggPj0gZWxlbWVudE1pZGRsZUhvcml6b250YWwpKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcGxhY2VBZnRlciA9IHBsYWNlaG9sZGVySW5kZXggPCB0aGlzSW5kZXg7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBpZiAocGxhY2VBZnRlcikge1xuICAgICAgICAgICAgICAgICAgICAgIGluc2VydEFmdGVyKGVsZW1lbnQsIHN0b3JlKHNvcnRhYmxlRWxlbWVudCkucGxhY2Vob2xkZXIpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgaW5zZXJ0QmVmb3JlKGVsZW1lbnQsIHN0b3JlKHNvcnRhYmxlRWxlbWVudCkucGxhY2Vob2xkZXIpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgLy8gZ2V0IHBsYWNlaG9sZGVycyBmcm9tIGFsbCBzdG9yZXMgJiByZW1vdmUgYWxsIGJ1dCBjdXJyZW50IG9uZVxuICAgICAgICAgICAgICAgICAgQXJyYXkuZnJvbShzdG9yZXMudmFsdWVzKCkpXG4gICAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGVtcHR5IHZhbHVlc1xuICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGRhdGEpIHsgcmV0dXJuIGRhdGEucGxhY2Vob2xkZXIgIT09IHVuZGVmaW5lZDsgfSlcbiAgICAgICAgICAgICAgICAgICAgICAvLyBmb3JlYWNoIHBsYWNlaG9sZGVyIGluIGFycmF5IGlmIG91dHNpZGUgb2YgY3VycmVudCBzb3JhYmxlQ29udGFpbmVyIC0+IHJlbW92ZSBmcm9tIERPTVxuICAgICAgICAgICAgICAgICAgICAgIC5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEucGxhY2Vob2xkZXIgIT09IHN0b3JlKHNvcnRhYmxlRWxlbWVudCkucGxhY2Vob2xkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5wbGFjZWhvbGRlci5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIC8vIGdldCBhbGwgcGxhY2Vob2xkZXJzIGZyb20gc3RvcmVcbiAgICAgICAgICAgICAgICAgIHZhciBwbGFjZWhvbGRlcnMgPSBBcnJheS5mcm9tKHN0b3Jlcy52YWx1ZXMoKSlcbiAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChkYXRhKSB7IHJldHVybiBkYXRhLnBsYWNlaG9sZGVyICE9PSB1bmRlZmluZWQ7IH0pXG4gICAgICAgICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLnBsYWNlaG9sZGVyO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiBlbGVtZW50IGlzIG5vdCBpbiBwbGFjZWhvbGRlcnNcbiAgICAgICAgICAgICAgICAgIGlmIChwbGFjZWhvbGRlcnMuaW5kZXhPZihlbGVtZW50KSA9PT0gLTEgJiYgc29ydGFibGVFbGVtZW50ID09PSBlbGVtZW50ICYmICFmaWx0ZXIoZWxlbWVudC5jaGlsZHJlbiwgb3B0aW9ucy5pdGVtcykubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsgcmV0dXJuIGVsZW1lbnQucmVtb3ZlKCk7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoc3RvcmUoc29ydGFibGVFbGVtZW50KS5wbGFjZWhvbGRlcik7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9LCBvcHRpb25zLmRlYm91bmNlKTtcbiAgICAgICAgICAvLyBIYW5kbGUgZHJhZ292ZXIgYW5kIGRyYWdlbnRlciBldmVudHMgb24gZHJhZ2dhYmxlIGl0ZW1zXG4gICAgICAgICAgdmFyIG9uRHJhZ092ZXJFbnRlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQ7XG4gICAgICAgICAgICAgIHZhciBzb3J0YWJsZUVsZW1lbnQgPSBlbGVtZW50LmlzU29ydGFibGUgPT09IHRydWUgPyBlbGVtZW50IDogZmluZFNvcnRhYmxlKGVsZW1lbnQsIGUpO1xuICAgICAgICAgICAgICBlbGVtZW50ID0gZmluZERyYWdFbGVtZW50KHNvcnRhYmxlRWxlbWVudCwgZWxlbWVudCk7XG4gICAgICAgICAgICAgIGlmICghZHJhZ2dpbmcgfHwgIWxpc3RzQ29ubmVjdGVkKHNvcnRhYmxlRWxlbWVudCwgZHJhZ2dpbmcucGFyZW50RWxlbWVudCkgfHwgYWRkRGF0YShzb3J0YWJsZUVsZW1lbnQsICdfZGlzYWJsZWQnKSA9PT0gJ3RydWUnKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBhZGREYXRhKHNvcnRhYmxlRWxlbWVudCwgJ29wdHMnKTtcbiAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KG9wdGlvbnMubWF4SXRlbXMpICYmIGZpbHRlcihzb3J0YWJsZUVsZW1lbnQuY2hpbGRyZW4sIGFkZERhdGEoc29ydGFibGVFbGVtZW50LCAnaXRlbXMnKSkubGVuZ3RoID4gcGFyc2VJbnQob3B0aW9ucy5tYXhJdGVtcykgJiYgZHJhZ2dpbmcucGFyZW50RWxlbWVudCAhPT0gc29ydGFibGVFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICBlLmRhdGFUcmFuc2Zlci5kcm9wRWZmZWN0ID0gc3RvcmUoc29ydGFibGVFbGVtZW50KS5nZXRDb25maWcoJ2NvcHknKSA9PT0gdHJ1ZSA/ICdjb3B5JyA6ICdtb3ZlJztcbiAgICAgICAgICAgICAgZGVib3VuY2VkRHJhZ092ZXJFbnRlcihzb3J0YWJsZUVsZW1lbnQsIGVsZW1lbnQsIGUucGFnZVgsIGUucGFnZVkpO1xuICAgICAgICAgIH07XG4gICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihsaXN0SXRlbXMuY29uY2F0KHNvcnRhYmxlRWxlbWVudCksICdkcmFnb3ZlcicsIG9uRHJhZ092ZXJFbnRlcik7XG4gICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihsaXN0SXRlbXMuY29uY2F0KHNvcnRhYmxlRWxlbWVudCksICdkcmFnZW50ZXInLCBvbkRyYWdPdmVyRW50ZXIpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gc29ydGFibGVFbGVtZW50cztcbiAgfVxuICBzb3J0YWJsZS5kZXN0cm95ID0gZnVuY3Rpb24gKHNvcnRhYmxlRWxlbWVudCkge1xuICAgICAgZGVzdHJveVNvcnRhYmxlKHNvcnRhYmxlRWxlbWVudCk7XG4gIH07XG4gIHNvcnRhYmxlLmVuYWJsZSA9IGZ1bmN0aW9uIChzb3J0YWJsZUVsZW1lbnQpIHtcbiAgICAgIGVuYWJsZVNvcnRhYmxlKHNvcnRhYmxlRWxlbWVudCk7XG4gIH07XG4gIHNvcnRhYmxlLmRpc2FibGUgPSBmdW5jdGlvbiAoc29ydGFibGVFbGVtZW50KSB7XG4gICAgICBkaXNhYmxlU29ydGFibGUoc29ydGFibGVFbGVtZW50KTtcbiAgfTtcbiAgLyogU1RBUlQuVEVTVFNfT05MWSAqL1xuICBzb3J0YWJsZS5fX3Rlc3RpbmcgPSB7XG4gICAgICAvLyBhZGQgaW50ZXJuYWwgbWV0aG9kcyBoZXJlIGZvciB0ZXN0aW5nIHB1cnBvc2VzXG4gICAgICBkYXRhOiBhZGREYXRhLFxuICAgICAgcmVtb3ZlSXRlbUV2ZW50czogcmVtb3ZlSXRlbUV2ZW50cyxcbiAgICAgIHJlbW92ZUl0ZW1EYXRhOiByZW1vdmVJdGVtRGF0YSxcbiAgICAgIHJlbW92ZVNvcnRhYmxlRGF0YTogcmVtb3ZlU29ydGFibGVEYXRhLFxuICAgICAgcmVtb3ZlQ29udGFpbmVyRXZlbnRzOiByZW1vdmVDb250YWluZXJFdmVudHNcbiAgfTtcblxuICByZXR1cm4gc29ydGFibGU7XG5cbn0oKSk7XG4iXX0=
